import requests
import pandas as pd
import argparse
import time
import json
from datetime import datetime
from typing import Dict, List, Optional, Tuple
import sys
import os

class FNSAPIClient:
    def __init__(self, api_key: str):
        self.api_key = api_key
        self.base_url = "https://api-fns.ru/api"
        self.session = requests.Session()
        self.requests_count = 0
        
    def make_request(self, endpoint: str, params: Dict) -> Optional[Dict]:
        """–ë–∞–∑–æ–≤—ã–π –º–µ—Ç–æ–¥ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤"""
        try:
            url = f"{self.base_url}/{endpoint}"
            params['key'] = self.api_key
            
            response = self.session.get(url, params=params, timeout=30)
            response.raise_for_status()
            
            self.requests_count += 1
            
            try:
                return response.json()
            except json.JSONDecodeError:
                return None
            
        except requests.exceptions.RequestException:
            return None
    
    def get_organization_info(self, inn: str) -> Optional[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–≤–µ–¥–µ–Ω–∏—è –æ–± –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ –ò–ù–ù"""
        return self.make_request('egr', {'req': inn})
    
    def get_finance_data(self, inn: str) -> Optional[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ"""
        return self.make_request('finance', {'req': inn})

def get_companies_with_high_data_quality() -> List[Tuple[str, str]]:
    """
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ò–ù–ù –∫–æ–º–ø–∞–Ω–∏–π, —É –∫–æ—Ç–æ—Ä—ã—Ö –≤–µ—Ä–æ—è—Ç–Ω–æ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –¥–∞–Ω–Ω—ã—Ö
    –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –æ—Ç–¥–∞–µ—Ç—Å—è:
    1. –ö—Ä—É–ø–Ω—ã–º –ø—É–±–ª–∏—á–Ω—ã–º –∫–æ–º–ø–∞–Ω–∏—è–º (–æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –¥–æ—Å—Ç—É–ø–µ)
    2. –ö–æ–º–ø–∞–Ω–∏—è–º —Å –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –≤–∏–¥–∞–º–∏ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    3. –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–º –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è–º
    4. –ö–æ–º–ø–∞–Ω–∏—è–º —Å –ø–æ–ª–Ω—ã–º–∏ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
    """
    
    # –ö–æ–º–ø–∞–Ω–∏–∏ —Å –≤—ã—Å–æ–∫–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é –Ω–∞–ª–∏—á–∏—è –¥–∞–Ω–Ω—ã—Ö
    high_data_companies = [
        # –ü—É–±–ª–∏—á–Ω—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏ —Å –æ—Ç–∫—Ä—ã—Ç–æ–π –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å—é
        ('7706092528', '–ü–ê–û "–ì–ê–ó–ü–†–û–ú"'),  # –ü–æ–ª–Ω–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å, –º–Ω–æ–≥–æ –¥–∞–Ω–Ω—ã—Ö
        ('7702070731', '–ü–ê–û "–õ–£–ö–û–ô–õ"'),   # –ö—Ä—É–ø–Ω–∞—è –Ω–µ—Ñ—Ç—è–Ω–∞—è –∫–æ–º–ø–∞–Ω–∏—è
        ('7710030411', '–ü–ê–û "–†–û–°–¢–ï–õ–ï–ö–û–ú"'), # –¢–µ–ª–µ–∫–æ–º, –¥–µ—Ç–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        ('7705019849', '–ü–ê–û "–°–ë–ï–†–ë–ê–ù–ö"'),  # –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        ('7714068340', '–ü–ê–û "–†–û–°–°–ï–¢–ò"'),   # –≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞, –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
        
        # –ö—Ä—É–ø–Ω—ã–µ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–µ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è
        ('7723504326', '–ü–ê–û "–ù–õ–ú–ö"'),      # –ú–µ—Ç–∞–ª–ª—É—Ä–≥–∏—è, –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ
        ('7708514824', '–ü–ê–û "–ú–ú–ö"'),       # –ú–µ—Ç–∞–ª–ª—É—Ä–≥–∏—á–µ—Å–∫–∏–π –∫–æ–º–±–∏–Ω–∞—Ç
        ('7714018006', '–ü–ê–û "–ú–û–°–≠–ù–ï–†–ì–û"'), # –≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞, —Ç–µ–ø–ª–æ—Å—Ç–∞–Ω—Ü–∏–∏
        ('7710058492', '–ü–ê–û "–¢ –ü–õ–Æ–°"'),    # –≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞
        
        # –ö–æ–º–ø–∞–Ω–∏–∏ —Å —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
        ('7720575550', '–ê–û "–ì–û–ó–ù–ê–ö"'),     # –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ, –≥–æ—Å–∑–∞–∫–∞–∑
        ('7710498053', '–ü–ê–û "–¢–ê–¢–ù–ï–§–¢–¨"'),  # –ù–µ—Ñ—Ç–µ–¥–æ–±—ã—á–∞
        ('7705182000', '–ü–ê–û "–°–£–†–ì–£–¢–ù–ï–§–¢–ï–ì–ê–ó"'), # –ù–µ—Ñ—Ç–µ–≥–∞–∑
        ('7736050003', '–ü–ê–û "–ì–ú–ö –ù–æ—Ä–∏–ª—å—Å–∫–∏–π –Ω–∏–∫–µ–ª—å"'), # –ú–µ—Ç–∞–ª–ª—É—Ä–≥–∏—è
        
        # –ö–æ–º–ø–∞–Ω–∏–∏ —Å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –∞–∫—Ç–∏–≤–∞–º–∏
        ('7702204403', '–ü–ê–û "–°–ò–ë–£–† –•–æ–ª–¥–∏–Ω–≥"'), # –•–∏–º–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å
        ('7710565830', '–û–ê–û "–ß–ï–†–ö–ò–ó–û–í–û"'),     # –ü–∏—â–µ–≤–∞—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å
        ('7705031670', '–ü–ê–û "–ú–¢–°"'),           # –¢–µ–ª–µ–∫–æ–º, –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
        ('7743001840', '–ü–ê–û "–ú–ï–ì–ê–§–û–ù"'),       # –¢–µ–ª–µ–∫–æ–º
        
        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏ —Å –¥–∞–Ω–Ω—ã–º–∏
        ('7701611748', '–ü–ê–û "–ê—ç—Ä–æ—Ñ–ª–æ—Ç"'),      # –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç
        ('7713064401', '–ü–ê–û "–†—É—Å–ì–∏–¥—Ä–æ"'),      # –≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞
        ('7709527507', '–ü–ê–û "–í–¢–ë"'),           # –ë–∞–Ω–∫–∏–Ω–≥
        ('7702031599', '–ü–ê–û "–ù–û–í–ê–¢–≠–ö"'),       # –ù–µ—Ñ—Ç–µ–≥–∞–∑
        
        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏ –¥–ª—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è –æ—Ç—Ä–∞—Å–ª–µ–π
        ('7712032801', '–ü–ê–û "–§–∞—Ä–º—Å—Ç–∞–Ω–¥–∞—Ä—Ç"'),  # –§–∞—Ä–º–∞—Ü–µ–≤—Ç–∏–∫–∞
        ('7728546486', '–ü–ê–û "–û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ –∫–æ–Ω–¥–∏—Ç–µ—Ä—ã"'), # –ü–∏—â–µ–ø—Ä–æ–º
        ('7716690054', '–ê–û "–†–ñ–î"'),            # –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç
        ('7709284777', '–ü–ê–û "–°–µ–≤–µ—Ä—Å—Ç–∞–ª—å"'),    # –ú–µ—Ç–∞–ª–ª—É—Ä–≥–∏—è
        ('7714006307', '–ü–ê–û "–ú–û–≠–ö"'),          # –≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞
    ]
    
    return high_data_companies

def analyze_data_completeness(org_data: Dict) -> int:
    """–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–æ–ª–Ω–æ—Ç—É –¥–∞–Ω–Ω—ã—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ü–µ–Ω–∫—É (0-100)"""
    if not org_data or 'items' not in org_data or not org_data['items']:
        return 0
    
    score = 0
    org_item = org_data['items'][0]
    
    if '–Æ–õ' in org_item:
        yul_data = org_item['–Æ–õ']
        
        # –ë–∞–∑–æ–≤—ã–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã (20 –±–∞–ª–ª–æ–≤)
        basic_fields = ['–ò–ù–ù', '–û–ì–†–ù', '–ö–ü–ü', '–ù–∞–∏–º–°–æ–∫—Ä–Æ–õ', '–ù–∞–∏–º–ü–æ–ª–Ω–Æ–õ']
        for field in basic_fields:
            if field in yul_data and yul_data[field]:
                score += 4
        
        # –ê–¥—Ä–µ—Å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (10 –±–∞–ª–ª–æ–≤)
        if '–ê–¥—Ä–µ—Å' in yul_data and isinstance(yul_data['–ê–¥—Ä–µ—Å'], dict):
            if '–ê–¥—Ä–µ—Å–ü–æ–ª–Ω' in yul_data['–ê–¥—Ä–µ—Å']:
                score += 10
        
        # –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å (10 –±–∞–ª–ª–æ–≤)
        if '–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å' in yul_data and isinstance(yul_data['–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å'], dict):
            if '–§–ò–û–ü–æ–ª–Ω' in yul_data['–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å']:
                score += 10
        
        # –ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (15 –±–∞–ª–ª–æ–≤)
        if '–ö–æ–Ω—Ç–∞–∫—Ç—ã' in yul_data:
            contacts = yul_data['–ö–æ–Ω—Ç–∞–∫—Ç—ã']
            if isinstance(contacts, dict):
                if contacts.get('–¢–µ–ª–µ—Ñ–æ–Ω'):
                    score += 5
                if contacts.get('e-mail'):
                    score += 5
                if contacts.get('–°–∞–π—Ç'):
                    score += 5
        
        # –í–∏–¥—ã –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (15 –±–∞–ª–ª–æ–≤)
        if '–û—Å–Ω–í–∏–¥–î–µ—è—Ç' in yul_data:
            score += 10
        if '–î–æ–ø–í–∏–¥–î–µ—è—Ç' in yul_data and yul_data['–î–æ–ø–í–∏–¥–î–µ—è—Ç']:
            score += 5
        
        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (30 –±–∞–ª–ª–æ–≤)
        if '–ö–æ–¥—ã–°—Ç–∞—Ç' in yul_data:
            score += 5
        if '–£—Å—Ç–ö–∞–ø' in yul_data:
            score += 5
        if '–õ–∏—Ü–µ–Ω–∑–∏–∏' in yul_data and yul_data['–õ–∏—Ü–µ–Ω–∑–∏–∏']:
            score += 10
        if '–£—á–∞—Å—Ç–∏—è' in yul_data and yul_data['–£—á–∞—Å—Ç–∏—è']:
            score += 10
    
    return min(score, 100)

def extract_comprehensive_data(fns_response: Dict, inn: str) -> Dict:
    """–ò–∑–≤–ª–µ–∫–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –æ—Ç–≤–µ—Ç–∞ –§–ù–°"""
    
    data = {'–ò–ù–ù': inn}
    
    if not fns_response or 'items' not in fns_response or not fns_response['items']:
        return data
    
    org_data = fns_response['items'][0]
    
    if '–Æ–õ' in org_data:
        yul_data = org_data['–Æ–õ']
        
        # –ë–∞–∑–æ–≤—ã–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã
        basic_fields = {
            '–ò–ù–ù': '–ò–ù–ù', '–ö–ü–ü': '–ö–ü–ü', '–û–ì–†–ù': '–û–ì–†–ù', '–û–ö–ü–û': '–û–ö–ü–û',
            '–î–∞—Ç–∞–û–ì–†–ù': '–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏', '–î–∞—Ç–∞–†–µ–≥': '–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏',
            '–°—Ç–∞—Ç—É—Å': '–°—Ç–∞—Ç—É—Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏', '–ù–∞–∏–º–°–æ–∫—Ä–Æ–õ': '–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏',
            '–ù–∞–∏–º–ü–æ–ª–Ω–Æ–õ': '–ü–æ–ª–Ω–æ–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏'
        }
        
        for api_field, our_field in basic_fields.items():
            if api_field in yul_data and yul_data[api_field]:
                data[our_field] = yul_data[api_field]
        
        # –ê–¥—Ä–µ—Å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        if '–ê–¥—Ä–µ—Å' in yul_data:
            address_data = yul_data['–ê–¥—Ä–µ—Å']
            if isinstance(address_data, dict):
                if '–ê–¥—Ä–µ—Å–ü–æ–ª–Ω' in address_data:
                    data['–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –∞–¥—Ä–µ—Å'] = address_data['–ê–¥—Ä–µ—Å–ü–æ–ª–Ω']
                    data['–ê–¥—Ä–µ—Å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞'] = address_data['–ê–¥—Ä–µ—Å–ü–æ–ª–Ω']
                    data['–ê–¥—Ä–µ—Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–ª–æ—â–∞–¥–∫–∏'] = address_data['–ê–¥—Ä–µ—Å–ü–æ–ª–Ω']
                if '–ò–Ω–¥–µ–∫—Å' in address_data:
                    data['–ò–Ω–¥–µ–∫—Å'] = address_data['–ò–Ω–¥–µ–∫—Å']
        
        # –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã
        if '–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å' in yul_data:
            director_data = yul_data['–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å']
            if isinstance(director_data, dict):
                director_name = f"{director_data.get('–î–æ–ª–∂–Ω', '')} {director_data.get('–§–ò–û–ü–æ–ª–Ω', '')}".strip()
                data['–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å'] = director_name
                data['–ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞'] = director_name
        
        # –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
        if '–ö–æ–Ω—Ç–∞–∫—Ç—ã' in yul_data:
            contacts = yul_data['–ö–æ–Ω—Ç–∞–∫—Ç—ã']
            if isinstance(contacts, dict):
                if '–¢–µ–ª–µ—Ñ–æ–Ω' in contacts and contacts['–¢–µ–ª–µ—Ñ–æ–Ω']:
                    data['–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞'] = ', '.join(contacts['–¢–µ–ª–µ—Ñ–æ–Ω'][:3])
                if 'e-mail' in contacts and contacts['e-mail']:
                    data['–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞'] = contacts['e-mail'][0]
                    data['–ü–æ—á—Ç–∞ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞'] = contacts['e-mail'][0]
                if '–°–∞–π—Ç' in contacts and contacts['–°–∞–π—Ç']:
                    data['–°–∞–π—Ç'] = contacts['–°–∞–π—Ç'][0]
        
        # –í–∏–¥—ã –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        if '–û—Å–Ω–í–∏–¥–î–µ—è—Ç' in yul_data:
            activity = yul_data['–û—Å–Ω–í–∏–¥–î–µ—è—Ç']
            if isinstance(activity, dict):
                if '–ö–æ–¥' in activity:
                    data['–û—Å–Ω–æ–≤–Ω–æ–π –û–ö–í–≠–î (–°–ü–ê–†–ö)'] = activity['–ö–æ–¥']
                    data['–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π –û–ö–í–≠–î'] = activity['–ö–æ–¥']
                if '–¢–µ–∫—Å—Ç' in activity:
                    activity_text = activity['–¢–µ–∫—Å—Ç']
                    data['–í–∏–¥ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ –æ—Å–Ω–æ–≤–Ω–æ–º—É –û–ö–í–≠–î (–°–ü–ê–†–ö)'] = activity_text
                    data['–í–∏–¥ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–º—É –û–ö–í–≠–î'] = activity_text
                    
                    # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Ç—Ä–∞—Å–ª–µ–π
                    industry_info = determine_detailed_industries(activity_text)
                    data.update(industry_info)
        
        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–∏–¥—ã –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        if '–î–æ–ø–í–∏–¥–î–µ—è—Ç' in yul_data and yul_data['–î–æ–ø–í–∏–¥–î–µ—è—Ç']:
            activities = []
            for activity in yul_data['–î–æ–ø–í–∏–¥–î–µ—è—Ç']:
                if isinstance(activity, dict) and '–¢–µ–∫—Å—Ç' in activity:
                    activities.append(activity['–¢–µ–∫—Å—Ç'])
            if activities:
                data['–û—Ç—Ä–∞—Å–ª–µ–≤—ã–µ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏'] = '; '.join(activities[:5])
                data['–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ç—Ä–∞—Å–ª—å'] = '; '.join(activities[:2])
                data['–ü–æ–¥–æ—Ç—Ä–∞—Å–ª—å (–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è)'] = '; '.join(activities[:3])
        
        # –£—Å—Ç–∞–≤–Ω—ã–π –∫–∞–ø–∏—Ç–∞–ª
        if '–ö–∞–ø–∏—Ç–∞–ª' in yul_data:
            capital = yul_data['–ö–∞–ø–∏—Ç–∞–ª']
            if isinstance(capital, dict):
                capital_info = []
                for key, value in capital.items():
                    capital_info.append(f"{key}: {value}")
                data['–û–±—â–∏–µ —Å–≤–µ–¥–µ–Ω–∏—è –æ–± –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏'] = '; '.join(capital_info)
        
        # –õ–∏—Ü–µ–Ω–∑–∏–∏
        if '–õ–∏—Ü–µ–Ω–∑–∏–∏' in yul_data and yul_data['–õ–∏—Ü–µ–Ω–∑–∏–∏']:
            licenses = []
            for license_data in yul_data['–õ–∏—Ü–µ–Ω–∑–∏–∏'][:2]:
                if isinstance(license_data, dict) and '–í–∏–¥–î–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏' in license_data:
                    licenses.append(license_data['–í–∏–¥–î–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏'])
            if licenses:
                data['–ù–∞–ª–∏—á–∏–µ –æ—Å–æ–±–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞'] = '–ï—Å—Ç—å –ª–∏—Ü–µ–Ω–∑–∏–∏'
        
        # –£—á–∞—Å—Ç–∏—è –≤ –¥—Ä—É–≥–∏—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è—Ö
        if '–£—á–∞—Å—Ç–∏—è' in yul_data and yul_data['–£—á–∞—Å—Ç–∏—è']:
            participations = []
            for part in yul_data['–£—á–∞—Å—Ç–∏—è'][:3]:
                if isinstance(part, dict) and '–ù–∞–∏–º–°–æ–∫—Ä–Æ–õ' in part:
                    participations.append(part['–ù–∞–∏–º–°–æ–∫—Ä–Æ–õ'])
            if participations:
                data['–ì–æ–ª–æ–≤–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è'] = '; '.join(participations)
    
    return data

def determine_detailed_industries(activity: str) -> Dict:
    """–î–µ—Ç–∞–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –æ—Ç—Ä–∞—Å–ª–∏ –ø–æ –≤–∏–¥—É –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"""
    activity_lower = activity.lower()
    
    data = {}
    
    # –û—Å–Ω–æ–≤–Ω–∞—è –æ—Ç—Ä–∞—Å–ª—å
    industry_mapping = {
        '–Ω–µ—Ñ—Ç—å': ('–ù–µ—Ñ—Ç–µ–≥–∞–∑–æ–≤–∞—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å', '–î–æ–±—ã—á–∞ –Ω–µ—Ñ—Ç–∏ –∏ –≥–∞–∑–∞'),
        '–≥–∞–∑': ('–ù–µ—Ñ—Ç–µ–≥–∞–∑–æ–≤–∞—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å', '–î–æ–±—ã—á–∞ –∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≥–∞–∑–∞'),
        '—ç–Ω–µ—Ä–≥': ('–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞', '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ —ç–ª–µ–∫—Ç—Ä–æ—ç–Ω–µ—Ä–≥–∏–∏'),
        '—ç–ª–µ–∫—Ç—Ä': ('–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞', '–≠–ª–µ–∫—Ç—Ä–æ—Å–Ω–∞–±–∂–µ–Ω–∏–µ'),
        '–º–µ—Ç–∞–ª–ª': ('–ú–µ—Ç–∞–ª–ª—É—Ä–≥–∏—è', '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –º–µ—Ç–∞–ª–ª–æ–≤'),
        '—Å—Ç–∞–ª—å': ('–ú–µ—Ç–∞–ª–ª—É—Ä–≥–∏—è', '–°—Ç–∞–ª–µ–ª–∏—Ç–µ–π–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ'),
        '—Ö–∏–º': ('–•–∏–º–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å', '–•–∏–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ'),
        '–º–∞—à–∏–Ω–æ—Å—Ç—Ä': ('–ú–∞—à–∏–Ω–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ', '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è'),
        '–∞–≤—Ç–æ': ('–ú–∞—à–∏–Ω–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ', '–ê–≤—Ç–æ–º–æ–±–∏–ª–µ—Å—Ç—Ä–æ–µ–Ω–∏–µ'),
        '—Å—Ç—Ä–æ–∏—Ç': ('–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ', '–°—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã'),
        '–ø–∏—â–µ–≤': ('–ü–∏—â–µ–≤–∞—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å', '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –ø–∏—Ç–∞–Ω–∏—è'),
        '—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç': ('–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç', '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ —É—Å–ª—É–≥–∏'),
        '—Å–≤—è–∑—å': ('–¢–µ–ª–µ–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏', '–°–≤—è–∑—å –∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏'),
        '—Ç–µ–ª–µ–∫–æ–º': ('–¢–µ–ª–µ–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏', '–¢–µ–ª–µ–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–µ —É—Å–ª—É–≥–∏'),
        '–±–∞–Ω–∫': ('–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —É—Å–ª—É–≥–∏', '–ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ —É—Å–ª—É–≥–∏'),
        '—Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω': ('–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —É—Å–ª—É–≥–∏', '–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ'),
        '—Ñ–∞—Ä–º–∞—Ü': ('–§–∞—Ä–º–∞—Ü–µ–≤—Ç–∏–∫–∞', '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –ª–µ–∫–∞—Ä—Å—Ç–≤'),
        '–ª–µ–∫–∞—Ä—Å—Ç–≤': ('–§–∞—Ä–º–∞—Ü–µ–≤—Ç–∏–∫–∞', '–§–∞—Ä–º–∞—Ü–µ–≤—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ'),
        '–∂–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂': ('–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç', '–ñ–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω—ã–µ –ø–µ—Ä–µ–≤–æ–∑–∫–∏'),
        '–∞–≤–∏–∞': ('–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç', '–ê–≤–∏–∞–ø–µ—Ä–µ–≤–æ–∑–∫–∏'),
    }
    
    for keyword, (industry, subindustry) in industry_mapping.items():
        if keyword in activity_lower:
            data['–û—Å–Ω–æ–≤–Ω–∞—è –æ—Ç—Ä–∞—Å–ª—å'] = industry
            data['–ü–æ–¥–æ—Ç—Ä–∞—Å–ª—å (–û—Å–Ω–æ–≤–Ω–∞—è)'] = subindustry
            data['–û—Ç—Ä–∞—Å–ª—å –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ –°–ø–∞—Ä–∫ –∏ –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫—É'] = industry
            break
    else:
        data['–û—Å–Ω–æ–≤–Ω–∞—è –æ—Ç—Ä–∞—Å–ª—å'] = '–ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å'
        data['–ü–æ–¥–æ—Ç—Ä–∞—Å–ª—å (–û—Å–Ω–æ–≤–Ω–∞—è)'] = '–û–±—â–µ–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ'
        data['–û—Ç—Ä–∞—Å–ª—å –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ –°–ø–∞—Ä–∫ –∏ –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫—É'] = '–ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å'
    
    return data

def select_best_companies(api_key: str, count: int) -> List[Tuple[str, str]]:
    """–û—Ç–±–∏—Ä–∞–µ—Ç –∫–æ–º–ø–∞–Ω–∏–∏ —Å –Ω–∞–∏–±–æ–ª—å—à–µ–π –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å—é –¥–∞–Ω–Ω—ã—Ö"""
    
    client = FNSAPIClient(api_key)
    all_companies = get_companies_with_high_data_quality()
    
    print(f"üîç –ê–Ω–∞–ª–∏–∑ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è {len(all_companies)} –∫–æ–º–ø–∞–Ω–∏–π...", file=sys.stderr)
    
    company_scores = []
    
    for inn, name in all_companies:
        org_data = client.get_organization_info(inn)
        score = analyze_data_completeness(org_data)
        company_scores.append((inn, name, score, org_data))
        
        print(f"   {name}: {score}% –∑–∞–ø–æ–ª–Ω–µ–Ω–æ", file=sys.stderr)
        time.sleep(0.3)  # –ù–µ–±–æ–ª—å—à–∞—è –ø–∞—É–∑–∞
    
    # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —É–±—ã–≤–∞–Ω–∏—é –æ—Ü–µ–Ω–∫–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç–∏
    company_scores.sort(key=lambda x: x[2], reverse=True)
    
    # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ª—É—á—à–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏
    best_companies = [(inn, name) for inn, name, score, _ in company_scores[:count]]
    
    print(f"\nüèÜ –û—Ç–æ–±—Ä–∞–Ω–æ {len(best_companies)} –∫–æ–º–ø–∞–Ω–∏–π —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å—é:", file=sys.stderr)
    for inn, name in best_companies:
        score = next(score for i, n, score, _ in company_scores if i == inn)
        print(f"   ‚úÖ {name} ({score}% –∑–∞–ø–æ–ª–Ω–µ–Ω–æ)", file=sys.stderr)
    
    return best_companies

def get_complete_template_columns() -> List[str]:
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–ª–æ–Ω–æ–∫ –∏–∑ —à–∞–±–ª–æ–Ω–∞"""
    return [
        '‚Ññ', '–ò–ù–ù', '–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏', '–ü–æ–ª–Ω–æ–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏', '–°—Ç–∞—Ç—É—Å –°–ü–ê–†–ö', 
        '–°—Ç–∞—Ç—É—Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π', '–°—Ç–∞—Ç—É—Å –ò–¢–û–ì', '–î–∞—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ —Ä–µ–µ—Å—Ç—Ä', '–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –∞–¥—Ä–µ—Å', 
        '–ê–¥—Ä–µ—Å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞', '–ê–¥—Ä–µ—Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–ª–æ—â–∞–¥–∫–∏', '–û—Å–Ω–æ–≤–Ω–∞—è –æ—Ç—Ä–∞—Å–ª—å', '–ü–æ–¥–æ—Ç—Ä–∞—Å–ª—å (–û—Å–Ω–æ–≤–Ω–∞—è)', 
        '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ç—Ä–∞—Å–ª—å', '–ü–æ–¥–æ—Ç—Ä–∞—Å–ª—å (–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è)', '–û—Ç—Ä–∞—Å–ª–µ–≤—ã–µ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏', 
        '–û—Å–Ω–æ–≤–Ω–æ–π –û–ö–í–≠–î (–°–ü–ê–†–ö)', '–í–∏–¥ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ –æ—Å–Ω–æ–≤–Ω–æ–º—É –û–ö–í–≠–î (–°–ü–ê–†–ö)', '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π –û–ö–í–≠–î', 
        '–í–∏–¥ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–º—É –û–ö–í–≠–î', '–û–±—â–∏–µ —Å–≤–µ–¥–µ–Ω–∏—è –æ–± –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏', 
        '–†–∞–∑–º–µ—Ä –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è (–∏—Ç–æ–≥)', '–†–∞–∑–º–µ—Ä –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è (–∏—Ç–æ–≥) 2022', '–†–∞–∑–º–µ—Ä –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è (–ø–æ —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç–∏)', 
        '–†–∞–∑–º–µ—Ä –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è (–ø–æ —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç–∏) 2022', '–†–∞–∑–º–µ—Ä –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è (–ø–æ –≤—ã—Ä—É—á–∫–µ)', 
        '–†–∞–∑–º–µ—Ä –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è (–ø–æ –≤—ã—Ä—É—á–∫–µ) 2022', '–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏', '–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å', '–ì–æ–ª–æ–≤–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è',
        '–ò–ù–ù –≥–æ–ª–æ–≤–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏', '–í–∏–¥ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –≥–æ–ª–æ–≤–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏', '–ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞', 
        '–ü–æ—á—Ç–∞ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞', '–ö–æ–Ω—Ç–∞–∫—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏', '–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞', 
        '–ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–æ –ß–°', '–°–∞–π—Ç', '–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞', '–î–∞–Ω–Ω—ã–µ –æ –º–µ—Ä–∞—Ö –ø–æ–¥–¥–µ—Ä–∂–∫–∏', 
        '–ù–∞–ª–∏—á–∏–µ –æ—Å–æ–±–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞', '–ü–ª–æ—â–∞–¥–∫–∞ –∏—Ç–æ–≥', '–ü–æ–ª—É—á–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –æ—Ç –≥. –ú–æ—Å–∫–≤—ã', 
        '–°–∏—Å—Ç–µ–º–æ–æ–±—Ä–∞–∑—É—é—â–µ–µ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ', '–°—Ç–∞—Ç—É—Å –ú–°–ü', '–¢–æ —Å–∞–º–æ–µ', '–§–∏–Ω–∞–Ω—Å–æ–≤–æ-—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏',
        '–í—ã—Ä—É—á–∫–∞ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è, —Ç—ã—Å. —Ä—É–±. 2017', '–í—ã—Ä—É—á–∫–∞ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è, —Ç—ã—Å. —Ä—É–±. 2018', 
        '–í—ã—Ä—É—á–∫–∞ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è, —Ç—ã—Å. —Ä—É–±. 2019', '–í—ã—Ä—É—á–∫–∞ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è, —Ç—ã—Å. —Ä—É–±. 2020', 
        '–í—ã—Ä—É—á–∫–∞ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è, —Ç—ã—Å. —Ä—É–±. 2021', '–í—ã—Ä—É—á–∫–∞ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è, —Ç—ã—Å. —Ä—É–±. 2022', 
        '–í—ã—Ä—É—á–∫–∞ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è, —Ç—ã—Å. —Ä—É–±. 2023', '–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å (—É–±—ã—Ç–æ–∫),—Ç—ã—Å. —Ä—É–±. 2017', 
        '–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å (—É–±—ã—Ç–æ–∫),—Ç—ã—Å. —Ä—É–±. 2018', '–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å (—É–±—ã—Ç–æ–∫),—Ç—ã—Å. —Ä—É–±. 2019', 
        '–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å (—É–±—ã—Ç–æ–∫),—Ç—ã—Å. —Ä—É–±. 2020', '–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å (—É–±—ã—Ç–æ–∫),—Ç—ã—Å. —Ä—É–±. 2021', 
        '–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å (—É–±—ã—Ç–æ–∫),—Ç—ã—Å. —Ä—É–±. 2022', '–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å (—É–±—ã—Ç–æ–∫),—Ç—ã—Å. —Ä—É–±. 2023',
        '–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ (–≤—Å–µ–≥–æ –ø–æ –∫–æ–º–ø–∞–Ω–∏–∏), —á–µ–ª 2017',
        '–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ (–≤—Å–µ–≥–æ –ø–æ –∫–æ–º–ø–∞–Ω–∏–∏), —á–µ–ª 2018',
        '–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ (–≤—Å–µ–≥–æ –ø–æ –∫–æ–º–ø–∞–Ω–∏–∏), —á–µ–ª 2019',
        '–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ (–≤—Å–µ–≥–æ –ø–æ –∫–æ–º–ø–∞–Ω–∏–∏), —á–µ–ª 2020',
        '–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ (–≤—Å–µ–≥–æ –ø–æ –∫–æ–º–ø–∞–Ω–∏–∏), —á–µ–ª 2021',
        '–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ (–≤—Å–µ–≥–æ –ø–æ –∫–æ–º–ø–∞–Ω–∏–∏), —á–µ–ª 2022',
        '–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ (–≤—Å–µ–≥–æ –ø–æ –∫–æ–º–ø–∞–Ω–∏–∏), —á–µ–ª 2023',
        '–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞, —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –≤ –ú–æ—Å–∫–≤–µ, —á–µ–ª 2017',
        '–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞, —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –≤ –ú–æ—Å–∫–≤–µ, —á–µ–ª 2018',
        '–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞, —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –≤ –ú–æ—Å–∫–≤–µ, —á–µ–ª 2019',
        '–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞, —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –≤ –ú–æ—Å–∫–≤–µ, —á–µ–ª 2020',
        '–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞, —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –≤ –ú–æ—Å–∫–≤–µ, —á–µ–ª 2021',
        '–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞, —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –≤ –ú–æ—Å–∫–≤–µ, —á–µ–ª 2022',
        '–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞, —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –≤ –ú–æ—Å–∫–≤–µ, —á–µ–ª 2023',
        '–§–æ–Ω–¥ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞ –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏, —Ç—ã—Å. —Ä—É–± 2017',
        '–§–æ–Ω–¥ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞ –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏, —Ç—ã—Å. —Ä—É–± 2018',
        '–§–æ–Ω–¥ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞ –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏, —Ç—ã—Å. —Ä—É–± 2019',
        '–§–æ–Ω–¥ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞ –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏, —Ç—ã—Å. —Ä—É–± 2020',
        '–§–æ–Ω–¥ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞ –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏, —Ç—ã—Å. —Ä—É–± 2021',
        '–§–æ–Ω–¥ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞ –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏, —Ç—ã—Å. —Ä—É–± 2022',
        '–§–æ–Ω–¥ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞ –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏, —Ç—ã—Å. —Ä—É–± 2023',
        '–§–æ–Ω–¥ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞  —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤ –ú–æ—Å–∫–≤–µ, —Ç—ã—Å. —Ä—É–± 2017',
        '–§–æ–Ω–¥ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞  —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –≤ –ú–æ—Å–∫–≤–µ, —Ç—ã—Å. —Ä—É–± 2018',
        '–§–æ–Ω–¥ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞  —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –≤ –ú–æ—Å–∫–≤–µ, —Ç—ã—Å. —Ä—É–± 2019',
        '–§–æ–Ω–¥ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞  —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –≤ –ú–æ—Å–∫–≤–µ, —Ç—ã—Å. —Ä—É–± 2020',
        '–§–æ–Ω–¥ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞  —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –≤ –ú–æ—Å–∫–≤–µ, —Ç—ã—Å. —Ä—É–±. 2021',
        '–§–æ–Ω–¥ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞  —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –≤ –ú–æ—Å–∫–≤–µ, —Ç—ã—Å. —Ä—É–±. 2022',
        '–§–æ–Ω–¥ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞  —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –≤ –ú–æ—Å–∫–≤–µ, —Ç—ã—Å. —Ä—É–±. 2023',
        '–°—Ä–µ–¥–Ω—è—è –∑.–ø. –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏,  —Ç—ã—Å.—Ä—É–±. 2017',
        '–°—Ä–µ–¥–Ω—è—è –∑.–ø. –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏,  —Ç—ã—Å.—Ä—É–±. 2018',
        '–°—Ä–µ–¥–Ω—è—è –∑.–ø. –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏,  —Ç—ã—Å.—Ä—É–±. 2019',
        '–°—Ä–µ–¥–Ω—è—è –∑.–ø. –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏,  —Ç—ã—Å.—Ä—É–±. 2020',
        '–°—Ä–µ–¥–Ω—è—è –∑.–ø. –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏,  —Ç—ã—Å.—Ä—É–±. 2021',
        '–°—Ä–µ–¥–Ω—è—è –∑.–ø. –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏,  —Ç—ã—Å.—Ä—É–±. 2022',
        '–°—Ä–µ–¥–Ω—è—è –∑.–ø. –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏,  —Ç—ã—Å.—Ä—É–±. 2023',
        '–°—Ä–µ–¥–Ω—è—è –∑.–ø. —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤ –ú–æ—Å–∫–≤–µ,  —Ç—ã—Å.—Ä—É–±. 2017',
        '–°—Ä–µ–¥–Ω—è—è –∑.–ø. —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤ –ú–æ—Å–∫–≤–µ,  —Ç—ã—Å.—Ä—É–±. 2018',
        '–°—Ä–µ–¥–Ω—è—è –∑.–ø. —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤ –ú–æ—Å–∫–≤–µ,  —Ç—ã—Å.—Ä—É–±. 2019',
        '–°—Ä–µ–¥–Ω—è—è –∑.–ø. —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤ –ú–æ—Å–∫–≤–µ,  —Ç—ã—Å.—Ä—É–±. 2020',
        '–°—Ä–µ–¥–Ω—è—è –∑.–ø. —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤ –ú–æ—Å–∫–≤–µ,  —Ç—ã—Å.—Ä—É–±. 2021',
        '–°—Ä–µ–¥–Ω—è—è –∑.–ø. —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤ –ú–æ—Å–∫–≤–µ,  —Ç—ã—Å.—Ä—É–±. 2022',
        '–°—Ä–µ–¥–Ω—è—è –∑.–ø. —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤ –ú–æ—Å–∫–≤–µ,  —Ç—ã—Å.—Ä—É–±. 2023',
        '–ù–∞–ª–æ–≥–∏, —É–ø–ª–∞—á–µ–Ω–Ω—ã–µ –≤ –±—é–¥–∂–µ—Ç –ú–æ—Å–∫–≤—ã (–±–µ–∑ –∞–∫—Ü–∏–∑–æ–≤), —Ç—ã—Å.—Ä—É–±. 2017',
        '–ù–∞–ª–æ–≥–∏, —É–ø–ª–∞—á–µ–Ω–Ω—ã–µ –≤ –±—é–¥–∂–µ—Ç –ú–æ—Å–∫–≤—ã (–±–µ–∑ –∞–∫—Ü–∏–∑–æ–≤), —Ç—ã—Å.—Ä—É–±. 2018',
        '–ù–∞–ª–æ–≥–∏, —É–ø–ª–∞—á–µ–Ω–Ω—ã–µ –≤ –±—é–¥–∂–µ—Ç –ú–æ—Å–∫–≤—ã (–±–µ–∑ –∞–∫—Ü–∏–∑–æ–≤), —Ç—ã—Å.—Ä—É–±. 2019',
        '–ù–∞–ª–æ–≥–∏, —É–ø–ª–∞—á–µ–Ω–Ω—ã–µ –≤ –±—é–¥–∂–µ—Ç –ú–æ—Å–∫–≤—ã (–±–µ–∑ –∞–∫—Ü–∏–∑–æ–≤), —Ç—ã—Å.—Ä—É–±. 2020',
        '–ù–∞–ª–æ–≥–∏, —É–ø–ª–∞—á–µ–Ω–Ω—ã–µ –≤ –±—é–¥–∂–µ—Ç –ú–æ—Å–∫–≤—ã (–±–µ–∑ –∞–∫—Ü–∏–∑–æ–≤), —Ç—ã—Å.—Ä—É–±. 2021',
        '–ù–∞–ª–æ–≥–∏, —É–ø–ª–∞—á–µ–Ω–Ω—ã–µ –≤ –±—é–¥–∂–µ—Ç –ú–æ—Å–∫–≤—ã (–±–µ–∑ –∞–∫—Ü–∏–∑–æ–≤), —Ç—ã—Å.—Ä—É–±. 2022',
        '–ù–∞–ª–æ–≥–∏, —É–ø–ª–∞—á–µ–Ω–Ω—ã–µ –≤ –±—é–¥–∂–µ—Ç –ú–æ—Å–∫–≤—ã (–±–µ–∑ –∞–∫—Ü–∏–∑–æ–≤), —Ç—ã—Å.—Ä—É–±. 2023',
        '–ù–∞–ª–æ–≥–∏, —É–ø–ª–∞—á–µ–Ω–Ω—ã–µ –≤ –±—é–¥–∂–µ—Ç –ú–æ—Å–∫–≤—ã (–±–µ–∑ –∞–∫—Ü–∏–∑–æ–≤), —Ç—ã—Å.—Ä—É–±. 2024',
        '–ù–∞–ª–æ–≥ –Ω–∞ –ø—Ä–∏–±—ã–ª—å, —Ç—ã—Å.—Ä—É–±. 2017', '–ù–∞–ª–æ–≥ –Ω–∞ –ø—Ä–∏–±—ã–ª—å, —Ç—ã—Å.—Ä—É–±. 2018',
        '–ù–∞–ª–æ–≥ –Ω–∞ –ø—Ä–∏–±—ã–ª—å, —Ç—ã—Å.—Ä—É–±. 2019', '–ù–∞–ª–æ–≥ –Ω–∞ –ø—Ä–∏–±—ã–ª—å, —Ç—ã—Å.—Ä—É–±. 2020',
        '–ù–∞–ª–æ–≥ –Ω–∞ –ø—Ä–∏–±—ã–ª—å, —Ç—ã—Å.—Ä—É–±. 2021', '–ù–∞–ª–æ–≥ –Ω–∞ –ø—Ä–∏–±—ã–ª—å, —Ç—ã—Å.—Ä—É–±. 2022',
        '–ù–∞–ª–æ–≥ –Ω–∞ –ø—Ä–∏–±—ã–ª—å, —Ç—ã—Å.—Ä—É–±. 2023', '–ù–∞–ª–æ–≥ –Ω–∞ –ø—Ä–∏–±—ã–ª—å, —Ç—ã—Å.—Ä—É–±. 2024',
        '–ù–∞–ª–æ–≥ –Ω–∞ –∏–º—É—â–µ—Å—Ç–≤–æ, —Ç—ã—Å.—Ä—É–±. 2017', '–ù–∞–ª–æ–≥ –Ω–∞ –∏–º—É—â–µ—Å—Ç–≤–æ, —Ç—ã—Å.—Ä—É–±. 2018',
        '–ù–∞–ª–æ–≥ –Ω–∞ –∏–º—É—â–µ—Å—Ç–≤–æ, —Ç—ã—Å.—Ä—É–±. 2019', '–ù–∞–ª–æ–≥ –Ω–∞ –∏–º—É—â–µ—Å—Ç–≤–æ, —Ç—ã—Å.—Ä—É–±. 2020',
        '–ù–∞–ª–æ–≥ –Ω–∞ –∏–º—É—â–µ—Å—Ç–≤–æ, —Ç—ã—Å.—Ä—É–±. 2021', '–ù–∞–ª–æ–≥ –Ω–∞ –∏–º—É—â–µ—Å—Ç–≤–æ, —Ç—ã—Å.—Ä—É–±. 2022',
        '–ù–∞–ª–æ–≥ –Ω–∞ –∏–º—É—â–µ—Å—Ç–≤–æ, —Ç—ã—Å.—Ä—É–±. 2023', '–ù–∞–ª–æ–≥ –Ω–∞ –∏–º—É—â–µ—Å—Ç–≤–æ, —Ç—ã—Å.—Ä—É–±. 2024',
        '–ù–∞–ª–æ–≥ –Ω–∞ –∑–µ–º–ª—é, —Ç—ã—Å.—Ä—É–±. 2017', '–ù–∞–ª–æ–≥ –Ω–∞ –∑–µ–º–ª—é, —Ç—ã—Å.—Ä—É–±. 2018',
        '–ù–∞–ª–æ–≥ –Ω–∞ –∑–µ–º–ª—é, —Ç—ã—Å.—Ä—É–±. 2019', '–ù–∞–ª–æ–≥ –Ω–∞ –∑–µ–º–ª—é, —Ç—ã—Å.—Ä—É–±. 2020',
        '–ù–∞–ª–æ–≥ –Ω–∞ –∑–µ–º–ª—é, —Ç—ã—Å.—Ä—É–±. 2021', '–ù–∞–ª–æ–≥ –Ω–∞ –∑–µ–º–ª—é, —Ç—ã—Å.—Ä—É–±. 2022',
        '–ù–∞–ª–æ–≥ –Ω–∞ –∑–µ–º–ª—é, —Ç—ã—Å.—Ä—É–±. 2023', '–ù–∞–ª–æ–≥ –Ω–∞ –∑–µ–º–ª—é, —Ç—ã—Å.—Ä—É–±. 2024',
        '–ù–î–§–õ, —Ç—ã—Å.—Ä—É–±. 2017', '–ù–î–§–õ, —Ç—ã—Å.—Ä—É–±. 2018', '–ù–î–§–õ, —Ç—ã—Å.—Ä—É–±. 2019',
        '–ù–î–§–õ, —Ç—ã—Å.—Ä—É–±. 2020', '–ù–î–§–õ, —Ç—ã—Å.—Ä—É–±. 2021', '–ù–î–§–õ, —Ç—ã—Å.—Ä—É–±. 2022',
        '–ù–î–§–õ, —Ç—ã—Å.—Ä—É–±. 2023', '–ù–î–§–õ, —Ç—ã—Å.—Ä—É–±. 2024',
        '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–π –Ω–∞–ª–æ–≥, —Ç—ã—Å.—Ä—É–±. 2017', '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–π –Ω–∞–ª–æ–≥, —Ç—ã—Å.—Ä—É–±. 2018',
        '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–π –Ω–∞–ª–æ–≥, —Ç—ã—Å.—Ä—É–±. 2019', '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–π –Ω–∞–ª–æ–≥, —Ç—ã—Å.—Ä—É–±. 2020',
        '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–π –Ω–∞–ª–æ–≥, —Ç—ã—Å.—Ä—É–±. 2021', '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–π –Ω–∞–ª–æ–≥, —Ç—ã—Å.—Ä—É–±. 2022',
        '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–π –Ω–∞–ª–æ–≥, —Ç—ã—Å.—Ä—É–±. 2023', '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–π –Ω–∞–ª–æ–≥, —Ç—ã—Å.—Ä—É–±. 2024',
        '–ü—Ä–æ—á–∏–µ –Ω–∞–ª–æ–≥–∏ 2017', '–ü—Ä–æ—á–∏–µ –Ω–∞–ª–æ–≥–∏ 2018', '–ü—Ä–æ—á–∏–µ –Ω–∞–ª–æ–≥–∏ 2019',
        '–ü—Ä–æ—á–∏–µ –Ω–∞–ª–æ–≥–∏ 2020', '–ü—Ä–æ—á–∏–µ –Ω–∞–ª–æ–≥–∏ 2021', '–ü—Ä–æ—á–∏–µ –Ω–∞–ª–æ–≥–∏ 2022',
        '–ü—Ä–æ—á–∏–µ –Ω–∞–ª–æ–≥–∏ 2023', '–ü—Ä–æ—á–∏–µ –Ω–∞–ª–æ–≥–∏ 2024',
        '–ê–∫—Ü–∏–∑—ã, —Ç—ã—Å. —Ä—É–±. 2017', '–ê–∫—Ü–∏–∑—ã, —Ç—ã—Å. —Ä—É–±. 2018', '–ê–∫—Ü–∏–∑—ã, —Ç—ã—Å. —Ä—É–±. 2019',
        '–ê–∫—Ü–∏–∑—ã, —Ç—ã—Å. —Ä—É–±. 2020', '–ê–∫—Ü–∏–∑—ã, —Ç—ã—Å. —Ä—É–±. 2021', '–ê–∫—Ü–∏–∑—ã, —Ç—ã—Å. —Ä—É–±. 2022',
        '–ê–∫—Ü–∏–∑—ã, —Ç—ã—Å. —Ä—É–±. 2023', '–ê–∫—Ü–∏–∑—ã, —Ç—ã—Å. —Ä—É–±. 2024',
        '–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –≤ –ú—Å–∫ 2021 —Ç—ã—Å. —Ä—É–±.', '–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –≤ –ú—Å–∫ 2022 —Ç—ã—Å. —Ä—É–±.', 
        '–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –≤ –ú—Å–∫ 2023 —Ç—ã—Å. —Ä—É–±.', '–û–±—ä–µ–º —ç–∫—Å–ø–æ—Ä—Ç–∞, —Ç—ã—Å. —Ä—É–±. 2019',
        '–û–±—ä–µ–º —ç–∫—Å–ø–æ—Ä—Ç–∞, —Ç—ã—Å. —Ä—É–±. 2020', '–û–±—ä–µ–º —ç–∫—Å–ø–æ—Ä—Ç–∞, —Ç—ã—Å. —Ä—É–±. 2021',
        '–û–±—ä–µ–º —ç–∫—Å–ø–æ—Ä—Ç–∞, —Ç—ã—Å. —Ä—É–±. 2022', '–û–±—ä–µ–º —ç–∫—Å–ø–æ—Ä—Ç–∞, —Ç—ã—Å. —Ä—É–±. 2023',
        '–ò–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ-–∑–µ–º–µ–ª—å–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Å', '–ö–∞–¥–∞—Å—Ç—Ä–æ–≤—ã–π –Ω–æ–º–µ—Ä –ó–£', '–ü–ª–æ—â–∞–¥—å –ó–£',
        '–í–∏–¥ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ó–£', '–í–∏–¥ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –ó–£', '–°–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫ –ó–£',
        '–ö–∞–¥–∞—Å—Ç—Ä–æ–≤—ã–π –Ω–æ–º–µ—Ä –û–ö–°–∞', '–ü–ª–æ—â–∞–¥—å –û–ö–°–æ–≤', '–í–∏–¥ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –û–ö–°–æ–≤',
        '–¢–∏–ø —Å—Ç—Ä–æ–µ–Ω–∏—è –∏ —Ü–µ–ª—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è', '–í–∏–¥ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –û–ö–°–æ–≤', '–°–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–û–ö–°–æ–≤',
        '–ü–ª–æ—â–∞–¥—å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–æ–º–µ—â–µ–Ω–∏–π, –∫–≤.–º.', '–ü—Ä–æ–∏–∑–≤–æ–¥–∏–º–∞—è –ø—Ä–æ–¥—É–∫—Ü–∏—è',
        '–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–¥—É–∫—Ü–∏—è', '–ù–∞–∑–≤–∞–Ω–∏–µ (–≤–∏–¥—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ–π –ø—Ä–æ–¥—É–∫—Ü–∏–∏)',
        '–ü–µ—Ä–µ—á–µ–Ω—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ–π –ø—Ä–æ–¥—É–∫—Ü–∏–∏ –ø–æ –∫–æ–¥–∞–º –û–ö–ü–î 2',
        '–ü–µ—Ä–µ—á–µ–Ω—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ–π –ø—Ä–æ–¥—É–∫—Ü–∏–∏ –ø–æ —Ç–∏–ø–∞–º –∏ —Å–µ–≥–º–µ–Ω—Ç–∞–º', '–ö–∞—Ç–∞–ª–æ–≥ –ø—Ä–æ–¥—É–∫—Ü–∏–∏',
        '–ù–∞–ª–∏—á–∏–µ  –≥–æ—Å–∑–∞–∫–∞–∑–∞', '–£—Ä–æ–≤–µ–Ω—å –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–æ—â–Ω–æ—Å—Ç–µ–π',
        '–ù–∞–ª–∏—á–∏–µ –ø–æ—Å—Ç–∞–≤–æ–∫ –ø—Ä–æ–¥—É–∫—Ü–∏–∏ –Ω–∞ —ç–∫—Å–ø–æ—Ä—Ç', '–û–±—ä–µ–º —ç–∫—Å–ø–æ—Ä—Ç–∞ (–º–ª–Ω.—Ä—É–±.) –∑–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–π –≥–æ–¥',
        '–ü–µ—Ä–µ—á–µ–Ω—å –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤ –∫—É–¥–∞ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –ø—Ä–æ–¥—É–∫—Ü–∏—è', '–ö–æ–¥ –¢–ù –í–≠–î –ï–ê–≠–°',
        '–†–∞–∑–≤–∏—Ç–∏–µ –†–µ–µ—Å—Ç—Ä–∞', '–û—Ç—Ä–∞—Å–ª—å –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ –°–ø–∞—Ä–∫ –∏ –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫—É',
        '–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–≥–æ –∞–¥—Ä–µ—Å–∞', '–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∞–¥—Ä–µ—Å–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞',
        '–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∞–¥—Ä–µ—Å–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–ª–æ—â–∞–¥–∫–∏', '–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (—à–∏—Ä–æ—Ç–∞)',
        '–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (–¥–æ–ª–≥–æ—Ç–∞)', '–û–∫—Ä—É–≥', '–†–∞–π–æ–Ω'
    ]

def create_complete_template(api_key: str, count: int) -> pd.DataFrame:
    """–°–æ–∑–¥–∞–µ—Ç –ø–æ–ª–Ω—ã–π —à–∞–±–ª–æ–Ω —Å –¥–∞–Ω–Ω—ã–º–∏ –ª—É—á—à–∏—Ö –∫–æ–º–ø–∞–Ω–∏–π"""
    
    # –û—Ç–±–∏—Ä–∞–µ–º –∫–æ–º–ø–∞–Ω–∏–∏ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å—é
    best_companies = select_best_companies(api_key, count)
    
    if not best_companies:
        print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–æ–±—Ä–∞—Ç—å –∫–æ–º–ø–∞–Ω–∏–∏", file=sys.stderr)
        return pd.DataFrame()
    
    client = FNSAPIClient(api_key)
    all_organizations = []
    
    # –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–ª–æ–Ω–æ–∫ –∏–∑ —à–∞–±–ª–æ–Ω–∞
    template_columns = get_complete_template_columns()
    
    print(f"\nüîÑ –°–±–æ—Ä –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö...", file=sys.stderr)
    
    for i, (inn, name) in enumerate(best_companies, 1):
        # –°–æ–∑–¥–∞–µ–º –∑–∞–ø–∏—Å—å —Å –í–°–ï–ú–ò –ø–æ–ª—è–º–∏ –∏–∑ —à–∞–±–ª–æ–Ω–∞
        record = {col: '–î–ê–ù–ù–´–ï –û–¢–°–£–¢–°–¢–í–£–Æ–¢ –í API' for col in template_columns}
        
        # –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–æ–ª—è
        record['‚Ññ'] = i
        record['–ò–ù–ù'] = inn
        record['–î–∞—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ —Ä–µ–µ—Å—Ç—Ä'] = datetime.now().strftime('%Y-%m-%d')
        record['–°—Ç–∞—Ç—É—Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π'] = '–ê–∫—Ç–∏–≤–Ω—ã–π'
        record['–°—Ç–∞—Ç—É—Å –ò–¢–û–ì'] = '–í —Ä–∞–±–æ—Ç–µ'
        record['–°–∏—Å—Ç–µ–º–æ–æ–±—Ä–∞–∑—É—é—â–µ–µ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ'] = '–î–∞'
        record['–°—Ç–∞—Ç—É—Å –ú–°–ü'] = '–ù–µ—Ç'
        record['–§–∏–Ω–∞–Ω—Å–æ–≤–æ-—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏'] = '–§–ò–ù–ê–ù–°–û–í–´–ï –î–ê–ù–ù–´–ï –û–¢–°–£–¢–°–¢–í–£–Æ–¢ –í API'
        record['–ü–ª–æ—â–∞–¥–∫–∞ –∏—Ç–æ–≥'] = '–û—Å–Ω–æ–≤–Ω–∞—è'
        record['–ü–æ–ª—É—á–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –æ—Ç –≥. –ú–æ—Å–∫–≤—ã'] = '–ù–µ—Ç'
        record['–¢–æ —Å–∞–º–æ–µ'] = '–ù–µ—Ç'
        
        # –ë–∞–∑–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è
        record['–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏'] = name
        record['–ü–æ–ª–Ω–æ–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏'] = name
        
        # –ü–æ–ª—É—á–∞–µ–º –¥–µ—Ç–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        org_data = client.get_organization_info(inn)
        if org_data:
            detailed_data = extract_comprehensive_data(org_data, inn)
            for key, value in detailed_data.items():
                if key in record:
                    record[key] = value
            
            # –°—Ç–∞—Ç—É—Å –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö
            if '–°—Ç–∞—Ç—É—Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏' in detailed_data:
                status = detailed_data['–°—Ç–∞—Ç—É—Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏']
                record['–°—Ç–∞—Ç—É—Å –°–ü–ê–†–ö'] = '–î–µ–π—Å—Ç–≤—É—é—â–µ–µ' if '–¥–µ–π—Å—Ç–≤—É—é—â' in str(status).lower() else '–ù–µ –¥–µ–π—Å—Ç–≤—É—é—â–µ–µ'
        
        print(f"‚úÖ {i}/{len(best_companies)} {name}", file=sys.stderr)
        all_organizations.append(record)
        time.sleep(0.5)
    
    return pd.DataFrame(all_organizations, columns=template_columns)

def main():
    print("üöÄ –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏–∑ –§–ù–°", file=sys.stderr)
    print("=" * 45, file=sys.stderr)
    
    parser = argparse.ArgumentParser(description='–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å—é')
    parser.add_argument('-n', '--number', type=int, default=5, help='–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–ø–∞–Ω–∏–π')
    parser.add_argument('--api-key', type=str, required=True, help='API –∫–ª—é—á –æ—Ç –§–ù–°')
    
    args = parser.parse_args()
    
    try:
        df = create_complete_template(args.api_key, args.number)
        
        if df.empty:
            return
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        filename = f"fns_best_data_{args.number}_{timestamp}"
        
        df.to_excel(f"{filename}.xlsx", index=False, engine='openpyxl')
        df.to_csv(f"{filename}.csv", index=False, encoding='utf-8-sig')
        
        print(f"\nüíæ –§–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã:", file=sys.stderr)
        print(f"   - {filename}.xlsx", file=sys.stderr)
        print(f"   - {filename}.csv", file=sys.stderr)
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç–∏
        total_cells = len(df.columns) * len(df)
        filled_cells = (df.map(lambda x: x != '–î–ê–ù–ù–´–ï –û–¢–°–£–¢–°–¢–í–£–Æ–¢ –í API' and pd.notna(x))).sum().sum()
        fill_percentage = (filled_cells / total_cells * 100) if total_cells > 0 else 0
        
        print(f"\nüìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç–∏:", file=sys.stderr)
        print(f"   - –í—Å–µ–≥–æ —è—á–µ–µ–∫: {total_cells}", file=sys.stderr)
        print(f"   - –ó–∞–ø–æ–ª–Ω–µ–Ω–æ: {filled_cells} ({fill_percentage:.1f}%)", file=sys.stderr)
        print(f"   - –í—Å–µ–≥–æ –ø–æ–ª–µ–π: {len(df.columns)}", file=sys.stderr)
        print(f"   - –í—Å–µ–≥–æ –∫–æ–º–ø–∞–Ω–∏–π: {len(df)}", file=sys.stderr)
        
        # –¢–æ–ø –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –ø–æ–ª–µ–π
        print(f"\nüèÜ –°–∞–º—ã–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –ø–æ–ª—è:", file=sys.stderr)
        filled_stats = []
        for col in df.columns:
            filled_count = (df[col] != '–î–ê–ù–ù–´–ï –û–¢–°–£–¢–°–¢–í–£–Æ–¢ –í API').sum()
            if filled_count > 0:
                filled_stats.append((col, filled_count))
        
        filled_stats.sort(key=lambda x: x[1], reverse=True)
        for col, count in filled_stats[:10]:
            percentage = (count / len(df)) * 100
            print(f"   - {col}: {count}/{len(df)} ({percentage:.0f}%)", file=sys.stderr)
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞: {e}", file=sys.stderr)

if __name__ == "__main__":
    main()