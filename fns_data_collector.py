import requests
import pandas as pd
import argparse
import time
import json
from datetime import datetime
from typing import Dict, List, Optional, Tuple
import sys
import os


class FNSAPIClient:
    def __init__(self, api_key: str, base_url: str):
        self.api_key = api_key
        self.base_url = base_url
        self.session = requests.Session()
        self.requests_count = 0

    def make_request(self, endpoint: str, params: Dict) -> Optional[Dict]:

        try:
            url = f"{self.base_url}/{endpoint}"
            params['key'] = self.api_key

            response = self.session.get(url, params=params, timeout=30)
            response.raise_for_status()

            self.requests_count += 1

            try:
                return response.json()
            except json.JSONDecodeError:
                return None

        except requests.exceptions.RequestException:
            return None

    def get_organization_info(self, inn: str, endpoint: str = 'egr') -> Optional[Dict]:
        return self.make_request(endpoint, {'req': inn})


def extract_comprehensive_data(fns_response: Dict, inn: str) -> Dict:

    data = {'–ò–ù–ù': inn}

    if not fns_response or 'items' not in fns_response or not fns_response['items']:
        return data

    org_data = fns_response['items'][0]

    if '–Æ–õ' in org_data:
        yul_data = org_data['–Æ–õ']

        # === –ë–ê–ó–û–í–´–ï –†–ï–ö–í–ò–ó–ò–¢–´ ===
        basic_fields = {
            '–ò–ù–ù': '–ò–ù–ù', '–ö–ü–ü': '–ö–ü–ü', '–û–ì–†–ù': '–û–ì–†–ù', '–û–ö–ü–û': '–û–ö–ü–û',
            '–î–∞—Ç–∞–û–ì–†–ù': '–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏', '–î–∞—Ç–∞–†–µ–≥': '–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏',
            '–°—Ç–∞—Ç—É—Å': '–°—Ç–∞—Ç—É—Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏', '–ù–∞–∏–º–°–æ–∫—Ä–Æ–õ': '–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏',
            '–ù–∞–∏–º–ü–æ–ª–Ω–Æ–õ': '–ü–æ–ª–Ω–æ–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏'
        }

        for api_field, our_field in basic_fields.items():
            if api_field in yul_data and yul_data[api_field]:
                data[our_field] = yul_data[api_field]

        # === –ê–î–†–ï–°–ù–´–ï –î–ê–ù–ù–´–ï ===
        if '–ê–¥—Ä–µ—Å' in yul_data:
            address_data = yul_data['–ê–¥—Ä–µ—Å']
            if isinstance(address_data, dict):
                if '–ê–¥—Ä–µ—Å–ü–æ–ª–Ω' in address_data:
                    full_address = address_data['–ê–¥—Ä–µ—Å–ü–æ–ª–Ω']
                    data['–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –∞–¥—Ä–µ—Å'] = full_address
                    data['–ê–¥—Ä–µ—Å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞'] = full_address
                    data['–ê–¥—Ä–µ—Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–ª–æ—â–∞–¥–∫–∏'] = full_address
                    
                if '–ò–Ω–¥–µ–∫—Å' in address_data:
                    data['–ò–Ω–¥–µ–∫—Å'] = address_data['–ò–Ω–¥–µ–∫—Å']

        # === –†–£–ö–û–í–û–î–ò–¢–ï–õ–¨ –ò –ö–û–ù–¢–ê–ö–¢–´ ===
        if '–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å' in yul_data:
            director_data = yul_data['–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å']
            if isinstance(director_data, dict):
                director_name = f"{director_data.get('–î–æ–ª–∂–Ω', '')} {director_data.get('–§–ò–û–ü–æ–ª–Ω', '')}".strip()
                data['–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å'] = director_name
                data['–ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞'] = director_name

        # === –ö–û–ù–¢–ê–ö–¢–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø ===
        if '–ö–æ–Ω—Ç–∞–∫—Ç—ã' in yul_data:
            contacts = yul_data['–ö–æ–Ω—Ç–∞–∫—Ç—ã']
            if isinstance(contacts, dict):
                if '–¢–µ–ª–µ—Ñ–æ–Ω' in contacts and contacts['–¢–µ–ª–µ—Ñ–æ–Ω']:
                    data['–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞'] = ', '.join(contacts['–¢–µ–ª–µ—Ñ–æ–Ω'][:3])
                
                if 'e-mail' in contacts and contacts['e-mail']:
                    data['–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞'] = contacts['e-mail'][0]
                    data['–ü–æ—á—Ç–∞ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞'] = contacts['e-mail'][0]
                
                if '–°–∞–π—Ç' in contacts and contacts['–°–∞–π—Ç']:
                    data['–°–∞–π—Ç'] = contacts['–°–∞–π—Ç'][0]

        # === –í–ò–î–´ –î–ï–Ø–¢–ï–õ–¨–ù–û–°–¢–ò –ò –û–¢–†–ê–°–õ–ò ===
        if '–û—Å–Ω–í–∏–¥–î–µ—è—Ç' in yul_data:
            activity = yul_data['–û—Å–Ω–í–∏–¥–î–µ—è—Ç']
            if isinstance(activity, dict):
                if '–ö–æ–¥' in activity:
                    data['–û—Å–Ω–æ–≤–Ω–æ–π –û–ö–í–≠–î (–°–ü–ê–†–ö)'] = activity['–ö–æ–¥']
                    data['–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π –û–ö–í–≠–î'] = activity['–ö–æ–¥']
                    
                if '–¢–µ–∫—Å—Ç' in activity:
                    activity_text = activity['–¢–µ–∫—Å—Ç']
                    data['–í–∏–¥ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ –æ—Å–Ω–æ–≤–Ω–æ–º—É –û–ö–í–≠–î (–°–ü–ê–†–ö)'] = activity_text
                    data['–í–∏–¥ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–º—É –û–ö–í–≠–î'] = activity_text
                    data['–û–±—â–∏–µ —Å–≤–µ–¥–µ–Ω–∏—è –æ–± –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏'] = activity_text

                    # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Ç—Ä–∞—Å–ª–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
                    industry_info = determine_detailed_industries(activity_text)
                    data.update(industry_info)

        # === –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –í–ò–î–´ –î–ï–Ø–¢–ï–õ–¨–ù–û–°–¢–ò ===
        if '–î–æ–ø–í–∏–¥–î–µ—è—Ç' in yul_data and yul_data['–î–æ–ø–í–∏–¥–î–µ—è—Ç']:
            activities = []
            okved_codes = []
            for activity in yul_data['–î–æ–ø–í–∏–¥–î–µ—è—Ç']:
                if isinstance(activity, dict) and '–¢–µ–∫—Å—Ç' in activity:
                    activities.append(activity['–¢–µ–∫—Å—Ç'])
                if isinstance(activity, dict) and '–ö–æ–¥' in activity:
                    okved_codes.append(activity['–ö–æ–¥'])
            
            if activities:
                data['–û—Ç—Ä–∞—Å–ª–µ–≤—ã–µ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏'] = '; '.join(activities[:5])
                data['–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ç—Ä–∞—Å–ª—å'] = '; '.join(activities[:2])
                data['–ü–æ–¥–æ—Ç—Ä–∞—Å–ª—å (–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è)'] = '; '.join(activities[:3])
            
            if okved_codes:
                data['–ü–µ—Ä–µ—á–µ–Ω—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ–π –ø—Ä–æ–¥—É–∫—Ü–∏–∏ –ø–æ –∫–æ–¥–∞–º –û–ö–ü–î 2'] = '; '.join(okved_codes[:5])

        # === –£–°–¢–ê–í–ù–´–ô –ö–ê–ü–ò–¢–ê–õ ===
        if '–ö–∞–ø–∏—Ç–∞–ª' in yul_data:
            capital = yul_data['–ö–∞–ø–∏—Ç–∞–ª']
            if isinstance(capital, dict):
                capital_info = []
                for key, value in capital.items():
                    capital_info.append(f"{key}: {value}")
                capital_text = '; '.join(capital_info)
                if '–û–±—â–∏–µ —Å–≤–µ–¥–µ–Ω–∏—è –æ–± –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏' in data:
                    data['–û–±—â–∏–µ —Å–≤–µ–¥–µ–Ω–∏—è –æ–± –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏'] += f"; {capital_text}"
                else:
                    data['–û–±—â–∏–µ —Å–≤–µ–¥–µ–Ω–∏—è –æ–± –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏'] = capital_text

        # === –õ–ò–¶–ï–ù–ó–ò–ò ===
        if '–õ–∏—Ü–µ–Ω–∑–∏–∏' in yul_data and yul_data['–õ–∏—Ü–µ–Ω–∑–∏–∏']:
            licenses = []
            for license_data in yul_data['–õ–∏—Ü–µ–Ω–∑–∏–∏'][:2]:
                if isinstance(license_data, dict) and '–í–∏–¥–î–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏' in license_data:
                    licenses.append(license_data['–í–∏–¥–î–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏'])
            if licenses:
                data['–ù–∞–ª–∏—á–∏–µ –æ—Å–æ–±–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞'] = '–ï—Å—Ç—å –ª–∏—Ü–µ–Ω–∑–∏–∏'

        # === –£–ß–ê–°–¢–ò–Ø –í –î–†–£–ì–ò–• –û–†–ì–ê–ù–ò–ó–ê–¶–ò–Ø–• ===
        if '–£—á–∞—Å—Ç–∏—è' in yul_data and yul_data['–£—á–∞—Å—Ç–∏—è']:
            participations = []
            inns = []
            for part in yul_data['–£—á–∞—Å—Ç–∏—è'][:3]:
                if isinstance(part, dict):
                    if '–ù–∞–∏–º–°–æ–∫—Ä–Æ–õ' in part:
                        participations.append(part['–ù–∞–∏–º–°–æ–∫—Ä–Æ–õ'])
                    if '–ò–ù–ù' in part:
                        inns.append(part['–ò–ù–ù'])
            
            if participations:
                data['–ì–æ–ª–æ–≤–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è'] = '; '.join(participations[:2])
            if inns:
                data['–ò–ù–ù –≥–æ–ª–æ–≤–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏'] = '; '.join(inns[:2])

        # === –°–¢–ê–¢–£–°–´ –ù–ê –û–°–ù–û–í–ï –†–ï–ê–õ–¨–ù–´–• –î–ê–ù–ù–´–• ===
        if '–°—Ç–∞—Ç—É—Å' in yul_data:
            status = yul_data['–°—Ç–∞—Ç—É—Å']
            data['–°—Ç–∞—Ç—É—Å –°–ü–ê–†–ö'] = '–î–µ–π—Å—Ç–≤—É—é—â–µ–µ' if '–¥–µ–π—Å—Ç–≤—É—é—â' in str(status).lower() else '–ù–µ –¥–µ–π—Å—Ç–≤—É—é—â–µ–µ'

    return data


def determine_detailed_industries(activity: str) -> Dict:
    
    activity_lower = activity.lower()

    data = {}

    # –û—Å–Ω–æ–≤–Ω–∞—è –æ—Ç—Ä–∞—Å–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤–∏–¥–∞ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    industry_mapping = {
        '–Ω–µ—Ñ—Ç—å': ('–ù–µ—Ñ—Ç–µ–≥–∞–∑–æ–≤–∞—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å', '–î–æ–±—ã—á–∞ –Ω–µ—Ñ—Ç–∏ –∏ –≥–∞–∑–∞'),
        '–≥–∞–∑': ('–ù–µ—Ñ—Ç–µ–≥–∞–∑–æ–≤–∞—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å', '–î–æ–±—ã—á–∞ –∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≥–∞–∑–∞'),
        '—ç–Ω–µ—Ä–≥': ('–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞', '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ —ç–ª–µ–∫—Ç—Ä–æ—ç–Ω–µ—Ä–≥–∏–∏'),
        '—ç–ª–µ–∫—Ç—Ä': ('–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞', '–≠–ª–µ–∫—Ç—Ä–æ—Å–Ω–∞–±–∂–µ–Ω–∏–µ'),
        '–º–µ—Ç–∞–ª–ª': ('–ú–µ—Ç–∞–ª–ª—É—Ä–≥–∏—è', '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –º–µ—Ç–∞–ª–ª–æ–≤'),
        '—Å—Ç–∞–ª—å': ('–ú–µ—Ç–∞–ª–ª—É—Ä–≥–∏—è', '–°—Ç–∞–ª–µ–ª–∏—Ç–µ–π–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ'),
        '—Ö–∏–º': ('–•–∏–º–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å', '–•–∏–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ'),
        '–º–∞—à–∏–Ω–æ—Å—Ç—Ä': ('–ú–∞—à–∏–Ω–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ', '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è'),
        '–∞–≤—Ç–æ': ('–ú–∞—à–∏–Ω–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ', '–ê–≤—Ç–æ–º–æ–±–∏–ª–µ—Å—Ç—Ä–æ–µ–Ω–∏–µ'),
        '—Å—Ç—Ä–æ–∏—Ç': ('–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ', '–°—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã'),
        '–ø–∏—â–µ–≤': ('–ü–∏—â–µ–≤–∞—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å', '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –ø–∏—Ç–∞–Ω–∏—è'),
        '—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç': ('–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç', '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ —É—Å–ª—É–≥–∏'),
        '—Å–≤—è–∑—å': ('–¢–µ–ª–µ–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏', '–°–≤—è–∑—å –∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏'),
        '—Ç–µ–ª–µ–∫–æ–º': ('–¢–µ–ª–µ–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏', '–¢–µ–ª–µ–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–µ —É—Å–ª—É–≥–∏'),
        '–±–∞–Ω–∫': ('–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —É—Å–ª—É–≥–∏', '–ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ —É—Å–ª—É–≥–∏'),
        '—Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω': ('–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —É—Å–ª—É–≥–∏', '–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ'),
        '—Ñ–∞—Ä–º–∞—Ü': ('–§–∞—Ä–º–∞—Ü–µ–≤—Ç–∏–∫–∞', '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –ª–µ–∫–∞—Ä—Å—Ç–≤'),
        '–ª–µ–∫–∞—Ä—Å—Ç–≤': ('–§–∞—Ä–º–∞—Ü–µ–≤—Ç–∏–∫–∞', '–§–∞—Ä–º–∞—Ü–µ–≤—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ'),
        '–∂–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂': ('–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç', '–ñ–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω—ã–µ –ø–µ—Ä–µ–≤–æ–∑–∫–∏'),
        '–∞–≤–∏–∞': ('–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç', '–ê–≤–∏–∞–ø–µ—Ä–µ–≤–æ–∑–∫–∏'),
    }

    for keyword, (industry, subindustry) in industry_mapping.items():
        if keyword in activity_lower:
            data['–û—Å–Ω–æ–≤–Ω–∞—è –æ—Ç—Ä–∞—Å–ª—å'] = industry
            data['–ü–æ–¥–æ—Ç—Ä–∞—Å–ª—å (–û—Å–Ω–æ–≤–Ω–∞—è)'] = subindustry
            data['–û—Ç—Ä–∞—Å–ª—å –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ –°–ø–∞—Ä–∫ –∏ –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫—É'] = industry
            break

    return data


def get_companies_data(api_key: str, companies_list: List[Dict]) -> List[Tuple[str, str]]:
    
    client = FNSAPIClient(api_key, base_url="https://api-fns.ru/api")
    
    
    company_results = []
    
    for company in companies_list:
        inn = company.get('inn')
        if not inn:
            continue
            
        # –ü–æ–ª—É—á–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ –µ—Å–ª–∏ –µ—Å—Ç—å –≤ —Å–ª–æ–≤–∞—Ä–µ
        name = company.get('name', f'–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è {inn}')
        
        org_data = client.get_organization_info(inn)
        
        if org_data:
            company_results.append((inn, name))

        else:
            company_results.append((inn, name))
        
        time.sleep(0.3) 
    
    return company_results


def get_complete_template_columns() -> List[str]:

    #–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–ª–æ–Ω–æ–∫ –∏–∑ —à–∞–±–ª–æ–Ω–∞
    return [
        '‚Ññ', '–ò–ù–ù', '–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏', '–ü–æ–ª–Ω–æ–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏', '–°—Ç–∞—Ç—É—Å –°–ü–ê–†–ö',
        '–°—Ç–∞—Ç—É—Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π', '–°—Ç–∞—Ç—É—Å –ò–¢–û–ì', '–î–∞—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ —Ä–µ–µ—Å—Ç—Ä', '–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –∞–¥—Ä–µ—Å',
        '–ê–¥—Ä–µ—Å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞', '–ê–¥—Ä–µ—Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–ª–æ—â–∞–¥–∫–∏', '–û—Å–Ω–æ–≤–Ω–∞—è –æ—Ç—Ä–∞—Å–ª—å', '–ü–æ–¥–æ—Ç—Ä–∞—Å–ª—å (–û—Å–Ω–æ–≤–Ω–∞—è)',
        '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ç—Ä–∞—Å–ª—å', '–ü–æ–¥–æ—Ç—Ä–∞—Å–ª—å (–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è)', '–û—Ç—Ä–∞—Å–ª–µ–≤—ã–µ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏',
        '–û—Å–Ω–æ–≤–Ω–æ–π –û–ö–í–≠–î (–°–ü–ê–†–ö)', '–í–∏–¥ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ –æ—Å–Ω–æ–≤–Ω–æ–º—É –û–ö–í–≠–î (–°–ü–ê–†–ö)', '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π –û–ö–í–≠–î',
        '–í–∏–¥ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–º—É –û–ö–í–≠–î', '–û–±—â–∏–µ —Å–≤–µ–¥–µ–Ω–∏—è –æ–± –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏',
        '–†–∞–∑–º–µ—Ä –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è (–∏—Ç–æ–≥)', '–†–∞–∑–º–µ—Ä –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è (–∏—Ç–æ–≥) 2022', '–†–∞–∑–º–µ—Ä –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è (–ø–æ —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç–∏)',
        '–†–∞–∑–º–µ—Ä –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è (–ø–æ —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç–∏) 2022', '–†–∞–∑–º–µ—Ä –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è (–ø–æ –≤—ã—Ä—É—á–∫–µ)',
        '–†–∞–∑–º–µ—Ä –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è (–ø–æ –≤—ã—Ä—É—á–∫–µ) 2022', '–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏', '–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å', '–ì–æ–ª–æ–≤–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è',
        '–ò–ù–ù –≥–æ–ª–æ–≤–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏', '–í–∏–¥ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –≥–æ–ª–æ–≤–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏', '–ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞',
        '–ü–æ—á—Ç–∞ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞', '–ö–æ–Ω—Ç–∞–∫—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏', '–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞',
        '–ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–æ –ß–°', '–°–∞–π—Ç', '–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞', '–î–∞–Ω–Ω—ã–µ –æ –º–µ—Ä–∞—Ö –ø–æ–¥–¥–µ—Ä–∂–∫–∏',
        '–ù–∞–ª–∏—á–∏–µ –æ—Å–æ–±–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞', '–ü–ª–æ—â–∞–¥–∫–∞ –∏—Ç–æ–≥', '–ü–æ–ª—É—á–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –æ—Ç –≥. –ú–æ—Å–∫–≤—ã',
        '–°–∏—Å—Ç–µ–º–æ–æ–±—Ä–∞–∑—É—é—â–µ–µ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ', '–°—Ç–∞—Ç—É—Å –ú–°–ü', '–¢–æ —Å–∞–º–æ–µ', '–§–∏–Ω–∞–Ω—Å–æ–≤–æ-—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏',
        '–í—ã—Ä—É—á–∫–∞ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è, —Ç—ã—Å. —Ä—É–±. 2017', '–í—ã—Ä—É—á–∫–∞ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è, —Ç—ã—Å. —Ä—É–±. 2018',
        '–í—ã—Ä—É—á–∫–∞ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è, —Ç—ã—Å. —Ä—É–±. 2019', '–í—ã—Ä—É—á–∫–∞ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è, —Ç—ã—Å. —Ä—É–±. 2020',
        '–í—ã—Ä—É—á–∫–∞ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è, —Ç—ã—Å. —Ä—É–±. 2021', '–í—ã—Ä—É—á–∫–∞ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è, —Ç—ã—Å. —Ä—É–±. 2022',
        '–í—ã—Ä—É—á–∫–∞ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è, —Ç—ã—Å. —Ä—É–±. 2023', '–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å (—É–±—ã—Ç–æ–∫),—Ç—ã—Å. —Ä—É–±. 2017',
        '–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å (—É–±—ã—Ç–æ–∫),—Ç—ã—Å. —Ä—É–±. 2018', '–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å (—É–±—ã—Ç–æ–∫),—Ç—ã—Å. —Ä—É–±. 2019',
        '–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å (—É–±—ã—Ç–æ–∫),—Ç—ã—Å. —Ä—É–±. 2020', '–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å (—É–±—ã—Ç–æ–∫),—Ç—ã—Å. —Ä—É–±. 2021',
        '–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å (—É–±—ã—Ç–æ–∫),—Ç—ã—Å. —Ä—É–±. 2022', '–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å (—É–±—ã—Ç–æ–∫),—Ç—ã—Å. —Ä—É–±. 2023',
        '–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ (–≤—Å–µ–≥–æ –ø–æ –∫–æ–º–ø–∞–Ω–∏–∏), —á–µ–ª 2017',
        '–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ (–≤—Å–µ–≥–æ –ø–æ –∫–æ–º–ø–∞–Ω–∏–∏), —á–µ–ª 2018',
        '–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ (–≤—Å–µ–≥–æ –ø–æ –∫–æ–º–ø–∞–Ω–∏–∏), —á–µ–ª 2019',
        '–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ (–≤—Å–µ–≥–æ –ø–æ –∫–æ–º–ø–∞–Ω–∏–∏), —á–µ–ª 2020',
        '–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ (–≤—Å–µ–≥–æ –ø–æ –∫–æ–º–ø–∞–Ω–∏–∏), —á–µ–ª 2021',
        '–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ (–≤—Å–µ–≥–æ –ø–æ –∫–æ–º–ø–∞–Ω–∏–∏), —á–µ–ª 2022',
        '–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ (–≤—Å–µ–≥–æ –ø–æ –∫–æ–º–ø–∞–Ω–∏–∏), —á–µ–ª 2023',
        '–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞, —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –≤ –ú–æ—Å–∫–≤–µ, —á–µ–ª 2017',
        '–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞, —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –≤ –ú–æ—Å–∫–≤–µ, —á–µ–ª 2018',
        '–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞, —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –≤ –ú–æ—Å–∫–≤–µ, —á–µ–ª 2019',
        '–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞, —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –≤ –ú–æ—Å–∫–≤–µ, —á–µ–ª 2020',
        '–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞, —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –≤ –ú–æ—Å–∫–≤–µ, —á–µ–ª 2021',
        '–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞, —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –≤ –ú–æ—Å–∫–≤–µ, —á–µ–ª 2022',
        '–°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞, —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –≤ –ú–æ—Å–∫–≤–µ, —á–µ–ª 2023',
        '–§–æ–Ω–¥ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞ –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏, —Ç—ã—Å. —Ä—É–± 2017',
        '–§–æ–Ω–¥ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞ –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏, —Ç—ã—Å. —Ä—É–± 2018',
        '–§–æ–Ω–¥ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞ –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏, —Ç—ã—Å. —Ä—É–± 2019',
        '–§–æ–Ω–¥ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞ –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏, —Ç—ã—Å. —Ä—É–± 2020',
        '–§–æ–Ω–¥ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞ –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏, —Ç—ã—Å. —Ä—É–± 2021',
        '–§–æ–Ω–¥ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞ –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏, —Ç—ã—Å. —Ä—É–± 2022',
        '–§–æ–Ω–¥ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞ –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏, —Ç—ã—Å. —Ä—É–± 2023',
        '–§–æ–Ω–¥ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞  —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤ –ú–æ—Å–∫–≤–µ, —Ç—ã—Å. —Ä—É–± 2017',
        '–§–æ–Ω–¥ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞  —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤ –ú–æ—Å–∫–≤–µ, —Ç—ã—Å. —Ä—É–± 2018',
        '–§–æ–Ω–¥ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞  —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤ –ú–æ—Å–∫–≤–µ, —Ç—ã—Å. —Ä—É–± 2019',
        '–§–æ–Ω–¥ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞  —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤ –ú–æ—Å–∫–≤–µ, —Ç—ã—Å. —Ä—É–± 2020',
        '–§–æ–Ω–¥ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞  —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤ –ú–æ—Å–∫–≤–µ, —Ç—ã—Å. —Ä—É–±. 2021',
        '–§–æ–Ω–¥ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞  —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤ –ú–æ—Å–∫–≤–µ, —Ç—ã—Å. —Ä—É–±. 2022',
        '–§–æ–Ω–¥ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞  —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤ –ú–æ—Å–∫–≤–µ, —Ç—ã—Å. —Ä—É–±. 2023',
        '–°—Ä–µ–¥–Ω—è—è –∑.–ø. –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏,  —Ç—ã—Å.—Ä—É–±. 2017',
        '–°—Ä–µ–¥–Ω—è—è –∑.–ø. –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏,  —Ç—ã—Å.—Ä—É–±. 2018',
        '–°—Ä–µ–¥–Ω—è—è –∑.–ø. –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏,  —Ç—ã—Å.—Ä—É–±. 2019',
        '–°—Ä–µ–¥–Ω—è—è –∑.–ø. –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏,  —Ç—ã—Å.—Ä—É–±. 2020',
        '–°—Ä–µ–¥–Ω—è—è –∑.–ø. –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏,  —Ç—ã—Å.—Ä—É–±. 2021',
        '–°—Ä–µ–¥–Ω—è—è –∑.–ø. –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏,  —Ç—ã—Å.—Ä—É–±. 2022',
        '–°—Ä–µ–¥–Ω—è—è –∑.–ø. –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏,  —Ç—ã—Å.—Ä—É–±. 2023',
        '–°—Ä–µ–¥–Ω—è—è –∑.–ø. —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤ –ú–æ—Å–∫–≤–µ,  —Ç—ã—Å.—Ä—É–±. 2017',
        '–°—Ä–µ–¥–Ω—è—è –∑.–ø. —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤ –ú–æ—Å–∫–≤–µ,  —Ç—ã—Å.—Ä—É–±. 2018',
        '–°—Ä–µ–¥–Ω—è—è –∑.–ø. —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤ –ú–æ—Å–∫–≤–µ,  —Ç—ã—Å.—Ä—É–±. 2019',
        '–°—Ä–µ–¥–Ω—è—è –∑.–ø. —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤ –ú–æ—Å–∫–≤–µ,  —Ç—ã—Å.—Ä—É–±. 2020',
        '–°—Ä–µ–¥–Ω—è—è –∑.–ø. —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤ –ú–æ—Å–∫–≤–µ,  —Ç—ã—Å.—Ä—É–±. 2021',
        '–°—Ä–µ–¥–Ω—è—è –∑.–ø. —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤ –ú–æ—Å–∫–≤–µ,  —Ç—ã—Å.—Ä—É–±. 2022',
        '–°—Ä–µ–¥–Ω—è—è –∑.–ø. —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤ –ú–æ—Å–∫–≤–µ,  —Ç—ã—Å.—Ä—É–±. 2023',
        '–ù–∞–ª–æ–≥–∏, —É–ø–ª–∞—á–µ–Ω–Ω—ã–µ –≤ –±—é–¥–∂–µ—Ç –ú–æ—Å–∫–≤—ã (–±–µ–∑ –∞–∫—Ü–∏–∑–æ–≤), —Ç—ã—Å.—Ä—É–±. 2017',
        '–ù–∞–ª–æ–≥–∏, —É–ø–ª–∞—á–µ–Ω–Ω—ã–µ –≤ –±—é–¥–∂–µ—Ç –ú–æ—Å–∫–≤—ã (–±–µ–∑ –∞–∫—Ü–∏–∑–æ–≤), —Ç—ã—Å.—Ä—É–±. 2018',
        '–ù–∞–ª–æ–≥–∏, —É–ø–ª–∞—á–µ–Ω–Ω—ã–µ –≤ –±—é–¥–∂–µ—Ç –ú–æ—Å–∫–≤—ã (–±–µ–∑ –∞–∫—Ü–∏–∑–æ–≤), —Ç—ã—Å.—Ä—É–±. 2019',
        '–ù–∞–ª–æ–≥–∏, —É–ø–ª–∞—á–µ–Ω–Ω—ã–µ –≤ –±—é–¥–∂–µ—Ç –ú–æ—Å–∫–≤—ã (–±–µ–∑ –∞–∫—Ü–∏–∑–æ–≤), —Ç—ã—Å.—Ä—É–±. 2020',
        '–ù–∞–ª–æ–≥–∏, —É–ø–ª–∞—á–µ–Ω–Ω—ã–µ –≤ –±—é–¥–∂–µ—Ç –ú–æ—Å–∫–≤—ã (–±–µ–∑ –∞–∫—Ü–∏–∑–æ–≤), —Ç—ã—Å.—Ä—É–±. 2021',
        '–ù–∞–ª–æ–≥–∏, —É–ø–ª–∞—á–µ–Ω–Ω—ã–µ –≤ –±—é–¥–∂–µ—Ç –ú–æ—Å–∫–≤—ã (–±–µ–∑ –∞–∫—Ü–∏–∑–æ–≤), —Ç—ã—Å.—Ä—É–±. 2022',
        '–ù–∞–ª–æ–≥–∏, —É–ø–ª–∞—á–µ–Ω–Ω—ã–µ –≤ –±—é–¥–∂–µ—Ç –ú–æ—Å–∫–≤—ã (–±–µ–∑ –∞–∫—Ü–∏–∑–æ–≤), —Ç—ã—Å.—Ä—É–±. 2023',
        '–ù–∞–ª–æ–≥–∏, —É–ø–ª–∞—á–µ–Ω–Ω—ã–µ –≤ –±—é–¥–∂–µ—Ç –ú–æ—Å–∫–≤—ã (–±–µ–∑ –∞–∫—Ü–∏–∑–æ–≤), —Ç—ã—Å.—Ä—É–±. 2024',
        '–ù–∞–ª–æ–≥ –Ω–∞ –ø—Ä–∏–±—ã–ª—å, —Ç—ã—Å.—Ä—É–±. 2017', '–ù–∞–ª–æ–≥ –Ω–∞ –ø—Ä–∏–±—ã–ª—å, —Ç—ã—Å.—Ä—É–±. 2018',
        '–ù–∞–ª–æ–≥ –Ω–∞ –ø—Ä–∏–±—ã–ª—å, —Ç—ã—Å.—Ä—É–±. 2019', '–ù–∞–ª–æ–≥ –Ω–∞ –ø—Ä–∏–±—ã–ª—å, —Ç—ã—Å.—Ä—É–±. 2020',
        '–ù–∞–ª–æ–≥ –Ω–∞ –ø—Ä–∏–±—ã–ª—å, —Ç—ã—Å.—Ä—É–±. 2021', '–ù–∞–ª–æ–≥ –Ω–∞ –ø—Ä–∏–±—ã–ª—å, —Ç—ã—Å.—Ä—É–±. 2022',
        '–ù–∞–ª–æ–≥ –Ω–∞ –ø—Ä–∏–±—ã–ª—å, —Ç—ã—Å.—Ä—É–±. 2023', '–ù–∞–ª–æ–≥ –Ω–∞ –ø—Ä–∏–±—ã–ª—å, —Ç—ã—Å.—Ä—É–±. 2024',
        '–ù–∞–ª–æ–≥ –Ω–∞ –∏–º—É—â–µ—Å—Ç–≤–æ, —Ç—ã—Å.—Ä—É–±. 2017', '–ù–∞–ª–æ–≥ –Ω–∞ –∏–º—É—â–µ—Å—Ç–≤–æ, —Ç—ã—Å.—Ä—É–±. 2018',
        '–ù–∞–ª–æ–≥ –Ω–∞ –∏–º—É—â–µ—Å—Ç–≤–æ, —Ç—ã—Å.—Ä—É–±. 2019', '–ù–∞–ª–æ–≥ –Ω–∞ –∏–º—É—â–µ—Å—Ç–≤–æ, —Ç—ã—Å.—Ä—É–±. 2020',
        '–ù–∞–ª–æ–≥ –Ω–∞ –∏–º—É—â–µ—Å—Ç–≤–æ, —Ç—ã—Å.—Ä—É–±. 2021', '–ù–∞–ª–æ–≥ –Ω–∞ –∏–º—É—â–µ—Å—Ç–≤–æ, —Ç—ã—Å.—Ä—É–±. 2022',
        '–ù–∞–ª–æ–≥ –Ω–∞ –∏–º—É—â–µ—Å—Ç–≤–æ, —Ç—ã—Å.—Ä—É–±. 2023', '–ù–∞–ª–æ–≥ –Ω–∞ –∏–º—É—â–µ—Å—Ç–≤–æ, —Ç—ã—Å.—Ä—É–±. 2024',
        '–ù–∞–ª–æ–≥ –Ω–∞ –∑–µ–º–ª—é, —Ç—ã—Å.—Ä—É–±. 2017', '–ù–∞–ª–æ–≥ –Ω–∞ –∑–µ–º–ª—é, —Ç—ã—Å.—Ä—É–±. 2018',
        '–ù–∞–ª–æ–≥ –Ω–∞ –∑–µ–º–ª—é, —Ç—ã—Å.—Ä—É–±. 2019', '–ù–∞–ª–æ–≥ –Ω–∞ –∑–µ–º–ª—é, —Ç—ã—Å.—Ä—É–±. 2020',
        '–ù–∞–ª–æ–≥ –Ω–∞ –∑–µ–º–ª—é, —Ç—ã—Å.—Ä—É–±. 2021', '–ù–∞–ª–æ–≥ –Ω–∞ –∑–µ–º–ª—é, —Ç—ã—Å.—Ä—É–±. 2022',
        '–ù–∞–ª–æ–≥ –Ω–∞ –∑–µ–º–ª—é, —Ç—ã—Å.—Ä—É–±. 2023', '–ù–∞–ª–æ–≥ –Ω–∞ –∑–µ–º–ª—é, —Ç—ã—Å.—Ä—É–±. 2024',
        '–ù–î–§–õ, —Ç—ã—Å.—Ä—É–±. 2017', '–ù–î–§–õ, —Ç—ã—Å.—Ä—É–±. 2018', '–ù–î–§–õ, —Ç—ã—Å.—Ä—É–±. 2019',
        '–ù–î–§–õ, —Ç—ã—Å.—Ä—É–±. 2020', '–ù–î–§–õ, —Ç—ã—Å.—Ä—É–±. 2021', '–ù–î–§–õ, —Ç—ã—Å.—Ä—É–±. 2022',
        '–ù–î–§–õ, —Ç—ã—Å.—Ä—É–±. 2023', '–ù–î–§–õ, —Ç—ã—Å.—Ä—É–±. 2024',
        '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–π –Ω–∞–ª–æ–≥, —Ç—ã—Å.—Ä—É–±. 2017', '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–π –Ω–∞–ª–æ–≥, —Ç—ã—Å.—Ä—É–±. 2018',
        '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–π –Ω–∞–ª–æ–≥, —Ç—ã—Å.—Ä—É–±. 2019', '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–π –Ω–∞–ª–æ–≥, —Ç—ã—Å.—Ä—É–±. 2020',
        '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–π –Ω–∞–ª–æ–≥, —Ç—ã—Å.—Ä—É–±. 2021', '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–π –Ω–∞–ª–æ–≥, —Ç—ã—Å.—Ä—É–±. 2022',
        '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–π –Ω–∞–ª–æ–≥, —Ç—ã—Å.—Ä—É–±. 2023', '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–π –Ω–∞–ª–æ–≥, —Ç—ã—Å.—Ä—É–±. 2024',
        '–ü—Ä–æ—á–∏–µ –Ω–∞–ª–æ–≥–∏ 2017', '–ü—Ä–æ—á–∏–µ –Ω–∞–ª–æ–≥–∏ 2018', '–ü—Ä–æ—á–∏–µ –Ω–∞–ª–æ–≥–∏ 2019',
        '–ü—Ä–æ—á–∏–µ –Ω–∞–ª–æ–≥–∏ 2020', '–ü—Ä–æ—á–∏–µ –Ω–∞–ª–æ–≥–∏ 2021', '–ü—Ä–æ—á–∏–µ –Ω–∞–ª–æ–≥–∏ 2022',
        '–ü—Ä–æ—á–∏–µ –Ω–∞–ª–æ–≥–∏ 2023', '–ü—Ä–æ—á–∏–µ –Ω–∞–ª–æ–≥–∏ 2024',
        '–ê–∫—Ü–∏–∑—ã, —Ç—ã—Å. —Ä—É–±. 2017', '–ê–∫—Ü–∏–∑—ã, —Ç—ã—Å. —Ä—É–±. 2018', '–ê–∫—Ü–∏–∑—ã, —Ç—ã—Å. —Ä—É–±. 2019',
        '–ê–∫—Ü–∏–∑—ã, —Ç—ã—Å. —Ä—É–±. 2020', '–ê–∫—Ü–∏–∑—ã, —Ç—ã—Å. —Ä—É–±. 2021', '–ê–∫—Ü–∏–∑—ã, —Ç—ã—Å. —Ä—É–±. 2022',
        '–ê–∫—Ü–∏–∑—ã, —Ç—ã—Å. —Ä—É–±. 2023', '–ê–∫—Ü–∏–∑—ã, —Ç—ã—Å. —Ä—É–±. 2024',
        '–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –≤ –ú—Å–∫ 2021 —Ç—ã—Å. —Ä—É–±.', '–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –≤ –ú—Å–∫ 2022 —Ç—ã—Å. —Ä—É–±.',
        '–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –≤ –ú—Å–∫ 2023 —Ç—ã—Å. —Ä—É–±.', '–û–±—ä–µ–º —ç–∫—Å–ø–æ—Ä—Ç–∞, —Ç—ã—Å. —Ä—É–±. 2019',
        '–û–±—ä–µ–º —ç–∫—Å–ø–æ—Ä—Ç–∞, —Ç—ã—Å. —Ä—É–±. 2020', '–û–±—ä–µ–º —ç–∫—Å–ø–æ—Ä—Ç–∞, —Ç—ã—Å. —Ä—É–±. 2021',
        '–û–±—ä–µ–º —ç–∫—Å–ø–æ—Ä—Ç–∞, —Ç—ã—Å. —Ä—É–±. 2022', '–û–±—ä–µ–º —ç–∫—Å–ø–æ—Ä—Ç–∞, —Ç—ã—Å. —Ä—É–±. 2023',
        '–ò–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ-–∑–µ–º–µ–ª—å–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Å', '–ö–∞–¥–∞—Å—Ç—Ä–æ–≤—ã–π –Ω–æ–º–µ—Ä –ó–£', '–ü–ª–æ—â–∞–¥—å –ó–£',
        '–í–∏–¥ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ó–£', '–í–∏–¥ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –ó–£', '–°–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫ –ó–£',
        '–ö–∞–¥–∞—Å—Ç—Ä–æ–≤—ã–π –Ω–æ–º–µ—Ä –û–ö–°–∞', '–ü–ª–æ—â–∞–¥—å –û–ö–°–æ–≤', '–í–∏–¥ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –û–ö–°–æ–≤',
        '–¢–∏–ø —Å—Ç—Ä–æ–µ–Ω–∏—è –∏ —Ü–µ–ª—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è', '–í–∏–¥ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –û–ö–°–æ–≤', '–°–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–û–ö–°–æ–≤',
        '–ü–ª–æ—â–∞–¥—å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–æ–º–µ—â–µ–Ω–∏–π, –∫–≤.–º.', '–ü—Ä–æ–∏–∑–≤–æ–¥–∏–º–∞—è –ø—Ä–æ–¥—É–∫—Ü–∏—è',
        '–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–¥—É–∫—Ü–∏—è', '–ù–∞–∑–≤–∞–Ω–∏–µ (–≤–∏–¥—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ–π –ø—Ä–æ–¥—É–∫—Ü–∏–∏)',
        '–ü–µ—Ä–µ—á–µ–Ω—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ–π –ø—Ä–æ–¥—É–∫—Ü–∏–∏ –ø–æ –∫–æ–¥–∞–º –û–ö–ü–î 2',
        '–ü–µ—Ä–µ—á–µ–Ω—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ–π –ø—Ä–æ–¥—É–∫—Ü–∏–∏ –ø–æ —Ç–∏–ø–∞–º –∏ —Å–µ–≥–º–µ–Ω—Ç–∞–º', '–ö–∞—Ç–∞–ª–æ–≥ –ø—Ä–æ–¥—É–∫—Ü–∏–∏',
        '–ù–∞–ª–∏—á–∏–µ  –≥–æ—Å–∑–∞–∫–∞–∑–∞', '–£—Ä–æ–≤–µ–Ω—å –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–æ—â–Ω–æ—Å—Ç–µ–π',
        '–ù–∞–ª–∏—á–∏–µ –ø–æ—Å—Ç–∞–≤–æ–∫ –ø—Ä–æ–¥—É–∫—Ü–∏–∏ –Ω–∞ —ç–∫—Å–ø–æ—Ä—Ç', '–û–±—ä–µ–º —ç–∫—Å–ø–æ—Ä—Ç–∞ (–º–ª–Ω.—Ä—É–±.) –∑–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–π –≥–æ–¥',
        '–ü–µ—Ä–µ—á–µ–Ω—å –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤ –∫—É–¥–∞ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –ø—Ä–æ–¥—É–∫—Ü–∏—è', '–ö–æ–¥ –¢–ù –í–≠–î –ï–ê–≠–°',
        '–†–∞–∑–≤–∏—Ç–∏–µ –†–µ–µ—Å—Ç—Ä–∞', '–û—Ç—Ä–∞—Å–ª—å –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ –°–ø–∞—Ä–∫ –∏ –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫—É',
        '–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–≥–æ –∞–¥—Ä–µ—Å–∞', '–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∞–¥—Ä–µ—Å–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞',
        '–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∞–¥—Ä–µ—Å–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–ª–æ—â–∞–¥–∫–∏', '–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (—à–∏—Ä–æ—Ç–∞)',
        '–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (–¥–æ–ª–≥–æ—Ç–∞)', '–û–∫—Ä—É–≥', '–†–∞–π–æ–Ω'
    ]


def create_complete_template(api_key: str, companies_list: List[Dict]) -> pd.DataFrame:

    companies = get_companies_data(api_key, companies_list)

    if not companies:
        print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ –∫–æ–º–ø–∞–Ω–∏—è–º", file=sys.stderr)
        return pd.DataFrame()

    client = FNSAPIClient(api_key, base_url="https://api-fns.ru/api")
    all_organizations = []

    template_columns = get_complete_template_columns()


    for i, (inn, name) in enumerate(companies, 1):

        record = {col: '–î–ê–ù–ù–´–ï –û–¢–°–£–¢–°–¢–í–£–Æ–¢ –í API' for col in template_columns}

        # –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–æ–ª—è
        record['‚Ññ'] = i
        record['–ò–ù–ù'] = inn
        record['–î–∞—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ —Ä–µ–µ—Å—Ç—Ä'] = datetime.now().strftime('%Y-%m-%d')
        record['–°—Ç–∞—Ç—É—Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π'] = '–ê–∫—Ç–∏–≤–Ω—ã–π'
        record['–°—Ç–∞—Ç—É—Å –ò–¢–û–ì'] = '–í —Ä–∞–±–æ—Ç–µ'
        record['–§–∏–Ω–∞–Ω—Å–æ–≤–æ-—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏'] = '–î–ê–ù–ù–´–ï –û–¢–°–£–¢–°–¢–í–£–Æ–¢ –í API'
        record['–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏'] = name
        record['–ü–æ–ª–Ω–æ–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏'] = name

        # –ü–æ–ª—É—á–∞–µ–º —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –§–ù–°
        org_data = client.get_organization_info(inn)
        if org_data:
            detailed_data = extract_comprehensive_data(org_data, inn)
            
            for key, value in detailed_data.items():
                if key in record and value:  
                    record[key] = value

        print(f"‚úÖ {i}/{len(companies)} {name}", file=sys.stderr)
        all_organizations.append(record)
        time.sleep(0.5)

    return pd.DataFrame(all_organizations, columns=template_columns)


def main():
    parser = argparse.ArgumentParser(description='–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π –∏–∑ –§–ù–°')
    parser.add_argument('--api-key', type=str, required=True, help='API –∫–ª—é—á –æ—Ç –§–ù–°')
    parser.add_argument('--companies-file', type=str, help='JSON —Ñ–∞–π–ª —Å–æ —Å–ø–∏—Å–∫–æ–º –∫–æ–º–ø–∞–Ω–∏–π')

    args = parser.parse_args()

    # –ü—Ä–∏–º–µ—Ä —Å–ø–∏—Å–∫–∞ –∫–æ–º–ø–∞–Ω–∏–π –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
    companies_to_process = [
        {'inn': '7706092528', 'name': '–ü–ê–û "–ì–ê–ó–ü–†–û–ú"'},
        {'inn': '7702070731', 'name': '–ü–ê–û "–õ–£–ö–û–ô–õ"'},
        {'inn': '7710030411', 'name': '–ü–ê–û "–†–û–°–¢–ï–õ–ï–ö–û–ú"'},
    ]

    # –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω —Ñ–∞–π–ª —Å –∫–æ–º–ø–∞–Ω–∏—è–º–∏, –∑–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ –Ω–µ–≥–æ
    if args.companies_file and os.path.exists(args.companies_file):
        try:
            with open(args.companies_file, 'r', encoding='utf-8') as f:
                companies_to_process = json.load(f)

        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞: {e}", file=sys.stderr)

    try:
        df = create_complete_template(args.api_key, companies_to_process)

        if df.empty:
            print("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–±—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ", file=sys.stderr)
            return

        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        filename = f"fns_data_{timestamp}"

        csv_filename = f"{filename}.csv"
        df.to_csv(csv_filename, index=False, encoding='utf-8-sig')
        

        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        total_fields = len(df.columns) * len(df)
        filled_fields = (df.map(lambda x: x != '–î–ê–ù–ù–´–ï –û–¢–°–£–¢–°–¢–í–£–Æ–¢ –í API' and pd.notna(x))).sum().sum()
        fill_percentage = (filled_fields / total_fields * 100) if total_fields > 0 else 0

        print(f"\nüìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:", file=sys.stderr)
        print(f"   - –ö–æ–º–ø–∞–Ω–∏–π –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: {len(df)}", file=sys.stderr)
        print(f"   - –í—Å–µ–≥–æ –ø–æ–ª–µ–π: {total_fields}", file=sys.stderr)
        print(f"   - –ó–∞–ø–æ–ª–Ω–µ–Ω–æ –ø–æ–ª–µ–π: {filled_fields} ({fill_percentage:.1f}%)", file=sys.stderr)

        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –¥–∞–Ω–Ω—ã—Ö
        print(f"\nüìã –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö (–ø–µ—Ä–≤—ã–µ 3 —Å—Ç—Ä–æ–∫–∏):", file=sys.stderr)
        preview_columns = ['‚Ññ', '–ò–ù–ù', '–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏', '–û—Å–Ω–æ–≤–Ω–∞—è –æ—Ç—Ä–∞—Å–ª—å', '–°—Ç–∞—Ç—É—Å –°–ü–ê–†–ö']
        available_columns = [col for col in preview_columns if col in df.columns]
        if available_columns:
            print(df[available_columns].head(3).to_string(index=False), file=sys.stderr)

    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞: {e}", file=sys.stderr)


if __name__ == "__main__":
    main()